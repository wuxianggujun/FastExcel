# FastExcel API å‚è€ƒ

è‡ªåŠ¨ä»å¤´æ–‡ä»¶æå–ï¼ˆå¯å‘å¼ï¼‰ï¼Œä»¥å®é™…æºç ä¸ºå‡†ã€‚

## ç›®å½•
- [Cell](#cell)
- [FASTEXCEL_API](#fastexcel_api)
- [NamedStyle](#namedstyle)
- [StyleBuilder](#stylebuilder)
- [Workbook](#workbook)
- [Worksheet](#worksheet)
- [fastexcel (namespace)](#fastexcel-(namespace))

## Cell

_Declared in: `src/fastexcel/core/Cell.hpp`_

- `Cell();`
- `~Cell();`
- `// ä¾¿åˆ©æ„é€ å‡½æ•° explicit Cell(const std::string& value);`
- `explicit Cell(const char* value);`
- `explicit Cell(double value);`
- `explicit Cell(int value);`
- `explicit Cell(bool value);`
- `// èµ‹å€¼è¿ç®—ï¼ˆV3é£æ ¼ä¾¿æ·APIï¼‰ Cell& operator=(double value);`
- `Cell& operator=(int value);`
- `Cell& operator=(bool value);`
- `Cell& operator=(const std::string& value);`
- `Cell& operator=(std::string_view value);`
- `Cell& operator=(const char* value);`
- `// å…¬å¼è®¾ç½® void setFormula(const std::string& formula, double result = 0.0);`
- `// å…±äº«å…¬å¼è®¾ç½® void setSharedFormula(int shared_index, double result = 0.0);`
- `void setSharedFormulaReference(int shared_index);`
- `// è·å–å€¼ CellType getType() const { // å¯¹å¤–APIç»Ÿä¸€ï¼šInlineStringä¹Ÿæ˜¾ç¤ºä¸ºString, SharedFormulaæ˜¾ç¤ºä¸ºFormula if (flags_.type == CellType::InlineString) return CellType::String;`
- `if (flags_.type == CellType::SharedFormula) return CellType::Formula;`
- `} // å†…éƒ¨æ–¹æ³•ï¼šè·å–çœŸå®çš„ç±»å‹ï¼ˆç”¨äºæµ‹è¯•å’Œå†…éƒ¨é€»è¾‘ï¼‰ CellType getInternalType() const { return flags_.type; } std::string getFormula() const;`
- `double getFormulaResult() const;`
- `// å…±äº«å…¬å¼è·å– int getSharedFormulaIndex() const;`
- `bool isSharedFormula() const;`
- `// æ ¼å¼æ“ä½œ - FormatDescriptoræ¶æ„ void setFormat(std::shared_ptr<const FormatDescriptor> format);`
- `std::shared_ptr<const FormatDescriptor> getFormatDescriptor() const;`
- `bool hasFormat() const { return flags_.has_format; } // è¶…é“¾æ¥æ“ä½œ void setHyperlink(const std::string& url);`
- `std::string getHyperlink() const;`
- `bool hasHyperlink() const { return flags_.has_hyperlink; } // æ‰¹æ³¨ï¼ˆæ³¨é‡Šï¼‰æ“ä½œ void setComment(const std::string& comment);`
- `std::string getComment() const;`
- `bool hasComment() const { return extended_ && extended_->comment; } // ğŸš€ æ–°APIï¼šæ¨¡æ¿åŒ–çš„å€¼è·å–å’Œè®¾ç½® template<typename T> T getValue() const { if constexpr (std::is_same_v<T, std::string>) { return getStringValue();`
- `} else if constexpr (std::is_floating_point_v<T>) { return static_cast<T>(getNumberValue());`
- `} else if constexpr (std::is_integral_v<T> && !std::is_same_v<T, bool>) { return static_cast<T>(getNumberValue());`
- `} else if constexpr (std::is_same_v<T, bool>) { return getBooleanValue();`
- `} else { static_assert(std::is_same_v<T, std::string>, "Unsupported type for Cell::getValue<T>()");`
- `} } template<typename T> void setValue(const T& value) { if constexpr (std::is_arithmetic_v<T> && !std::is_same_v<T, bool>) { setValueImpl(static_cast<double>(value));`
- `} else if constexpr (std::is_same_v<T, bool>) { setValueImpl(value);`
- `} else if constexpr (std::is_convertible_v<T, std::string>) { setValueImpl(std::string(value));`
- `} else { static_assert(std::is_arithmetic_v<T>, "Unsupported type for Cell::setValue<T>()");`
- `} } // ğŸš€ æ–°APIï¼šå®‰å…¨è®¿é—®æ–¹æ³• template<typename T> std::optional<T> tryGetValue() const noexcept { try { return getValue<T>();`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> T getValueOr(const T& default_value) const noexcept { return tryGetValue<T>().value_or(default_value);`
- `} // çŠ¶æ€æ£€æŸ¥ bool isEmpty() const { return flags_.type == CellType::Empty; } bool isNumber() const { return flags_.type == CellType::Number; } bool isString() const { return flags_.type == CellType::String || flags_.type == CellType::InlineString; } bool isBoolean() const { return flags_.type == CellType::Boolean; } bool isFormula() const { return flags_.type == CellType::Formula || flags_.type == CellType::SharedFormula; } bool isDate() const { return flags_.type == CellType::Date; } // ğŸš€ æ–°APIï¼šä¾¿æ·è®¿é—®æ–¹æ³•ï¼ˆç»Ÿä¸€å‘½åé£æ ¼ï¼‰ std::string asString() const { return getValue<std::string>(); } double asNumber() const { return getValue<double>(); } bool asBool() const { return getValue<bool>(); } int asInt() const { return getValue<int>(); } // ğŸš€ æ–°APIï¼šå®‰å…¨çš„ç±»å‹è½¬æ¢æ–¹æ³• template<typename T> bool canConvertTo() const noexcept { return tryGetValue<T>().has_value();`
  - è¯´æ˜ï¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥è½¬æ¢ä¸ºæŒ‡å®šç±»å‹
- `} template<typename T> std::optional<T> safeCast() const noexcept { return tryGetValue<T>();`
  - è¯´æ˜ï¼šå®‰å…¨ç±»å‹è½¬æ¢
- `} // æ¸…ç©º void clear();`
- `// å†…å­˜ä½¿ç”¨ç»Ÿè®¡ - è°ƒè¯•ç”¨ size_t getMemoryUsage() const;`
- `// ç§»åŠ¨è¯­ä¹‰ä¼˜åŒ– Cell(Cell&& other) noexcept;`
- `Cell& operator=(Cell&& other) noexcept;`
- `// æ‹·è´æ„é€ å’Œèµ‹å€¼ï¼ˆä¿æŒå…¼å®¹æ€§ï¼‰ Cell(const Cell& other);`
- `Cell& operator=(const Cell& other);`

## FASTEXCEL_API

FastExcelå¼‚å¸¸åŸºç±»(æ–°æ¶æ„)

_Declared in: `src/fastexcel/FastExcel.hpp`_

- `explicit FastExcelException(const std::string& message) : message_(message) {} const char* what() const noexcept override { return message_.c_str();`

## NamedStyle

å‘½åæ ·å¼ - å¸¦åç§°çš„æ ¼å¼æè¿°ç¬¦

_Declared in: `src/fastexcel/core/StyleBuilder.hpp`_

- `NamedStyle(const std::string& name, const FormatDescriptor& format) : name_(name), format_(format) {} NamedStyle(const std::string& name, const StyleBuilder& builder) : name_(name), format_(builder.build()) {} const std::string& getName() const { return name_; } const FormatDescriptor& getFormat() const { return format_; } bool operator==(const NamedStyle& other) const { return name_ == other.name_ && format_ == other.format_;`
- `} bool operator!=(const NamedStyle& other) const { return !(*this == other);`
- `} size_t hash() const { std::hash<std::string> str_hasher;`
- `return str_hasher(name_) ^ (format_.hash() << 1);`

## StyleBuilder

æ ·å¼æ„å»ºå™¨ - æµå¼APIåˆ›å»ºæ ¼å¼

_Declared in: `src/fastexcel/core/StyleBuilder.hpp`_

- `StyleBuilder() = default;`
- `// ä»ç°æœ‰æ ¼å¼åˆ›å»ºBuilderï¼ˆç”¨äºä¿®æ”¹ç°æœ‰æ ¼å¼ï¼‰ explicit StyleBuilder(const FormatDescriptor& format);`
- `// ========== å­—ä½“è®¾ç½®ï¼ˆé“¾å¼è°ƒç”¨ï¼‰ ========== StyleBuilder& fontName(const std::string& name) { font_name_ = name;`
  - è¯´æ˜ï¼šè®¾ç½®å­—ä½“åç§°
- `} StyleBuilder& fontSize(double size) { if (size >= 1.0 && size <= 409.0) { font_size_ = size;`
  - è¯´æ˜ï¼šè®¾ç½®å­—ä½“å¤§å°
- `} StyleBuilder& font(const std::string& name, double size) { return fontName(name).fontSize(size);`
  - è¯´æ˜ï¼šè®¾ç½®å­—ä½“ï¼ˆåç§°+å¤§å°ï¼‰
- `} StyleBuilder& font(const std::string& name, double size, bool is_bold) { return font(name, size).bold(is_bold);`
  - è¯´æ˜ï¼šè®¾ç½®å­—ä½“ï¼ˆåç§°+å¤§å°+ç²—ä½“ï¼‰
- `} StyleBuilder& fontColor(core::Color color) { font_color_ = color;`
  - è¯´æ˜ï¼šè®¾ç½®å­—ä½“é¢œè‰²
- `} StyleBuilder& bold(bool is_bold = true) { bold_ = is_bold;`
  - è¯´æ˜ï¼šè®¾ç½®ç²—ä½“
- `} StyleBuilder& italic(bool is_italic = true) { italic_ = is_italic;`
  - è¯´æ˜ï¼šè®¾ç½®æ–œä½“
- `} StyleBuilder& underline(UnderlineType type = UnderlineType::Single) { underline_ = type;`
  - è¯´æ˜ï¼šè®¾ç½®ä¸‹åˆ’çº¿
- `} StyleBuilder& strikeout(bool is_strikeout = true) { strikeout_ = is_strikeout;`
  - è¯´æ˜ï¼šè®¾ç½®åˆ é™¤çº¿
- `} StyleBuilder& superscript(bool is_super = true) { script_ = is_super ? FontScript::Superscript : FontScript::None;`
  - è¯´æ˜ï¼šè®¾ç½®ä¸Šæ ‡
- `} StyleBuilder& subscript(bool is_sub = true) { script_ = is_sub ? FontScript::Subscript : FontScript::None;`
  - è¯´æ˜ï¼šè®¾ç½®ä¸‹æ ‡
- `} // ========== å¯¹é½è®¾ç½® ========== StyleBuilder& horizontalAlign(HorizontalAlign align) { horizontal_align_ = align;`
  - è¯´æ˜ï¼šè®¾ç½®æ°´å¹³å¯¹é½
- `} StyleBuilder& verticalAlign(VerticalAlign align) { vertical_align_ = align;`
  - è¯´æ˜ï¼šè®¾ç½®å‚ç›´å¯¹é½
- `} StyleBuilder& leftAlign() { return horizontalAlign(HorizontalAlign::Left);`
  - è¯´æ˜ï¼šå·¦å¯¹é½
- `} StyleBuilder& centerAlign() { return horizontalAlign(HorizontalAlign::Center);`
  - è¯´æ˜ï¼šå±…ä¸­å¯¹é½
- `} StyleBuilder& rightAlign() { return horizontalAlign(HorizontalAlign::Right);`
  - è¯´æ˜ï¼šå³å¯¹é½
- `} StyleBuilder& vcenterAlign() { return verticalAlign(VerticalAlign::Center);`
  - è¯´æ˜ï¼šå‚ç›´å±…ä¸­
- `} StyleBuilder& textWrap(bool wrap = true) { text_wrap_ = wrap;`
  - è¯´æ˜ï¼šè®¾ç½®æ–‡æœ¬æ¢è¡Œ
- `} StyleBuilder& rotation(int16_t angle) { if ((angle >= -90 && angle <= 90) || angle == 270) { rotation_ = angle;`
  - è¯´æ˜ï¼šè®¾ç½®æ–‡æœ¬æ—‹è½¬è§’åº¦
- `} StyleBuilder& indent(uint8_t level) { indent_ = level;`
  - è¯´æ˜ï¼šè®¾ç½®ç¼©è¿›çº§åˆ«
- `} StyleBuilder& shrinkToFit(bool shrink_to_fit = true) { shrink_ = shrink_to_fit;`
  - è¯´æ˜ï¼šè®¾ç½®æ”¶ç¼©ä»¥é€‚åº”
- `} // ========== è¾¹æ¡†è®¾ç½® ========== StyleBuilder& border(BorderStyle style, core::Color color = core::Color::BLACK) { left_border_ = right_border_ = top_border_ = bottom_border_ = style;`
  - è¯´æ˜ï¼šè®¾ç½®æ‰€æœ‰è¾¹æ¡†
- `} StyleBuilder& leftBorder(BorderStyle style, core::Color color = core::Color::BLACK) { left_border_ = style;`
  - è¯´æ˜ï¼šè®¾ç½®å·¦è¾¹æ¡†
- `} StyleBuilder& rightBorder(BorderStyle style, core::Color color = core::Color::BLACK) { right_border_ = style;`
  - è¯´æ˜ï¼šè®¾ç½®å³è¾¹æ¡†
- `} StyleBuilder& topBorder(BorderStyle style, core::Color color = core::Color::BLACK) { top_border_ = style;`
  - è¯´æ˜ï¼šè®¾ç½®ä¸Šè¾¹æ¡†
- `} StyleBuilder& bottomBorder(BorderStyle style, core::Color color = core::Color::BLACK) { bottom_border_ = style;`
  - è¯´æ˜ï¼šè®¾ç½®ä¸‹è¾¹æ¡†
- `} StyleBuilder& diagonalBorder(BorderStyle style, DiagonalBorderType type = DiagonalBorderType::Both, core::Color color = core::Color::BLACK) { diag_border_ = style;`
  - è¯´æ˜ï¼šè®¾ç½®å¯¹è§’çº¿è¾¹æ¡†
- `} // ========== å¡«å……è®¾ç½® ========== StyleBuilder& fill(core::Color color) { pattern_ = PatternType::Solid;`
  - è¯´æ˜ï¼šè®¾ç½®å¡«å……ï¼ˆçº¯è‰²ï¼‰
- `} StyleBuilder& fill(PatternType pattern, core::Color bg_color, core::Color fg_color = core::Color::BLACK) { pattern_ = pattern;`
  - è¯´æ˜ï¼šè®¾ç½®å¡«å……æ¨¡å¼
- `} StyleBuilder& backgroundColor(core::Color color) { if (pattern_ == PatternType::None) { pattern_ = PatternType::Solid;`
  - è¯´æ˜ï¼šè®¾ç½®èƒŒæ™¯è‰²
- `} // ========== æ•°å­—æ ¼å¼è®¾ç½® ========== StyleBuilder& numberFormat(const std::string& format) { num_format_ = format;`
  - è¯´æ˜ï¼šè®¾ç½®æ•°å­—æ ¼å¼
- `} StyleBuilder& numberFormatIndex(uint16_t index) { num_format_index_ = index;`
  - è¯´æ˜ï¼šè®¾ç½®æ•°å­—æ ¼å¼ç´¢å¼•
- `num_format_.clear(); // æ¸…é™¤è‡ªå®šä¹‰æ ¼å¼ return *this;`
- `} // å¸¸ç”¨æ•°å­—æ ¼å¼çš„ä¾¿æ·æ–¹æ³• StyleBuilder& currency() { return numberFormatIndex(7); } // Â¤#,##0.00 StyleBuilder& percentage() { return numberFormatIndex(10); } // 0.00% StyleBuilder& date() { return numberFormatIndex(14); } // m/d/yyyy StyleBuilder& time() { return numberFormatIndex(21); } // h:mm:ss AM/PM StyleBuilder& dateTime() { return numberFormat("m/d/yyyy h:mm"); } StyleBuilder& scientific() { return numberFormatIndex(11); } // 0.00E+00 StyleBuilder& text() { return numberFormatIndex(49); } // @ // ========== ä¿æŠ¤è®¾ç½® ========== StyleBuilder& locked(bool locked = true) { locked_ = locked;`
  - è¯´æ˜ï¼šè®¾ç½®å•å…ƒæ ¼é”å®š
- `} StyleBuilder& unlocked(bool unlocked = true) { locked_ = !unlocked;`
  - è¯´æ˜ï¼šè®¾ç½®å•å…ƒæ ¼è§£é”
- `} StyleBuilder& hidden(bool hidden = true) { hidden_ = hidden;`
  - è¯´æ˜ï¼šè®¾ç½®å…¬å¼éšè—
- `} // ========== æ„å»ºæœ€ç»ˆå¯¹è±¡ ========== FormatDescriptor build() const;`
  - è¯´æ˜ï¼šæ„å»ºä¸å¯å˜çš„æ ¼å¼æè¿°ç¬¦
- `// ========== é¢„å®šä¹‰æ ·å¼çš„é™æ€å·¥å‚æ–¹æ³• ========== static StyleBuilder header() { return StyleBuilder() .bold() .fontSize(14) .centerAlign() .vcenterAlign();`
- `} static StyleBuilder title() { return StyleBuilder() .bold() .fontSize(16) .centerAlign() .vcenterAlign();`
- `} static StyleBuilder money() { return StyleBuilder() .currency() .rightAlign() .vcenterAlign();`
- `} static StyleBuilder percent() { return StyleBuilder() .percentage() .rightAlign() .vcenterAlign();`
- `} static StyleBuilder dateStyle() { return StyleBuilder() .date() .centerAlign() .vcenterAlign();`

## Workbook

Workbookç±» - Excelå·¥ä½œç°¿ï¼ˆæ–°æ¶æ„ï¼‰

_Declared in: `src/fastexcel/core/Workbook.hpp`_

- `static std::unique_ptr<Workbook> create(const Path& path);`
  - è¯´æ˜ï¼šåˆ›å»ºå·¥ä½œç°¿ï¼ˆç›´æ¥å¯ç”¨ï¼Œæ— éœ€å†è°ƒç”¨openï¼‰
- `static std::unique_ptr<Workbook> openForReading(const Path& path);`
  - è¯´æ˜ï¼šåªè¯»æ–¹å¼æ‰“å¼€Excelæ–‡ä»¶ï¼ˆæ–°API - æ¨èï¼‰
- `static std::unique_ptr<Workbook> openForEditing(const Path& path);`
  - è¯´æ˜ï¼šç¼–è¾‘æ–¹å¼æ‰“å¼€Excelæ–‡ä»¶ï¼ˆæ–°API - æ¨èï¼‰
- `explicit Workbook(const Path& path);`
  - è¯´æ˜ï¼šæ„é€ å‡½æ•°
- `~Workbook();`
  - è¯´æ˜ï¼šææ„å‡½æ•°
- `// ç¦ç”¨æ‹·è´æ„é€ å’Œèµ‹å€¼ Workbook(const Workbook&) = delete;`
- `Workbook& operator=(const Workbook&) = delete;`
- `// å…è®¸ç§»åŠ¨æ„é€ å’Œèµ‹å€¼ Workbook(Workbook&&) = default;`
- `Workbook& operator=(Workbook&&) = default;`
- `// ========== æ–‡ä»¶æ“ä½œ ========== bool save();`
  - è¯´æ˜ï¼šä¿å­˜å·¥ä½œç°¿
- `bool saveAs(const std::string& filename);`
  - è¯´æ˜ï¼šå¦å­˜ä¸º
- `bool isOpen() const;`
  - è¯´æ˜ï¼šæ£€æŸ¥å·¥ä½œç°¿æ˜¯å¦å·²æ‰“å¼€
- `bool close();`
  - è¯´æ˜ï¼šå…³é—­å·¥ä½œç°¿
- `// ========== ç¼–è¾‘æ¨¡å¼/ä¿çœŸå†™å›é…ç½® ========== void setPreserveUnknownParts(bool enable) { preserve_unknown_parts_ = enable; } bool getPreserveUnknownParts() const { return preserve_unknown_parts_; } // ========== å·¥ä½œè¡¨ç®¡ç† ========== std::shared_ptr<Worksheet> addSheet(const std::string& name = "");`
  - è¯´æ˜ï¼šæ·»åŠ å·¥ä½œè¡¨
- `std::shared_ptr<Worksheet> insertSheet(size_t index, const std::string& name = "");`
  - è¯´æ˜ï¼šæ’å…¥å·¥ä½œè¡¨
- `bool removeSheet(const std::string& name);`
  - è¯´æ˜ï¼šåˆ é™¤å·¥ä½œè¡¨
- `bool removeSheet(size_t index);`
  - è¯´æ˜ï¼šåˆ é™¤å·¥ä½œè¡¨
- `std::shared_ptr<Worksheet> getSheet(const std::string& name);`
  - è¯´æ˜ï¼šè·å–å·¥ä½œè¡¨ï¼ˆæŒ‰åç§°ï¼‰
- `std::shared_ptr<Worksheet> getSheet(size_t index);`
  - è¯´æ˜ï¼šè·å–å·¥ä½œè¡¨ï¼ˆæŒ‰ç´¢å¼•ï¼‰
- `std::shared_ptr<const Worksheet> getSheet(const std::string& name) const;`
  - è¯´æ˜ï¼šè·å–å·¥ä½œè¡¨ï¼ˆæŒ‰åç§°ï¼Œåªè¯»ï¼‰
- `std::shared_ptr<const Worksheet> getSheet(size_t index) const;`
  - è¯´æ˜ï¼šè·å–å·¥ä½œè¡¨ï¼ˆæŒ‰ç´¢å¼•ï¼Œåªè¯»ï¼‰
- `// ğŸš€ ä¾¿æ·çš„å·¥ä½œè¡¨è®¿é—®æ“ä½œç¬¦ std::shared_ptr<Worksheet> operator[](size_t index) { return getSheet(index);`
  - è¯´æ˜ï¼šé€šè¿‡ç´¢å¼•è®¿é—®å·¥ä½œè¡¨ï¼ˆæ“ä½œç¬¦é‡è½½ï¼‰
- `} std::shared_ptr<const Worksheet> operator[](size_t index) const { return getSheet(index);`
  - è¯´æ˜ï¼šé€šè¿‡ç´¢å¼•è®¿é—®å·¥ä½œè¡¨ï¼ˆåªè¯»æ“ä½œç¬¦é‡è½½ï¼‰
- `} std::shared_ptr<Worksheet> operator[](const std::string& name) { return getSheet(name);`
  - è¯´æ˜ï¼šé€šè¿‡åç§°è®¿é—®å·¥ä½œè¡¨ï¼ˆæ“ä½œç¬¦é‡è½½ï¼‰
- `} std::shared_ptr<const Worksheet> operator[](const std::string& name) const { return getSheet(name);`
  - è¯´æ˜ï¼šé€šè¿‡åç§°è®¿é—®å·¥ä½œè¡¨ï¼ˆåªè¯»æ“ä½œç¬¦é‡è½½ï¼‰
- `} size_t getSheetCount() const { return worksheets_.size(); } bool isEmpty() const { return worksheets_.empty(); } std::shared_ptr<Worksheet> getFirstSheet();`
  - è¯´æ˜ï¼šè·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
- `std::shared_ptr<const Worksheet> getFirstSheet() const;`
  - è¯´æ˜ï¼šè·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ï¼ˆåªè¯»ç‰ˆæœ¬ï¼‰
- `std::shared_ptr<Worksheet> getLastSheet();`
  - è¯´æ˜ï¼šè·å–æœ€åä¸€ä¸ªå·¥ä½œè¡¨
- `std::shared_ptr<const Worksheet> getLastSheet() const;`
  - è¯´æ˜ï¼šè·å–æœ€åä¸€ä¸ªå·¥ä½œè¡¨ï¼ˆåªè¯»ç‰ˆæœ¬ï¼‰
- `std::vector<std::string> getSheetNames() const;`
  - è¯´æ˜ï¼šè·å–æ‰€æœ‰å·¥ä½œè¡¨åç§°
- `// ğŸš€ æ–°APIï¼šä¾¿æ·çš„å·¥ä½œè¡¨æŸ¥æ‰¾æ–¹æ³• bool hasSheet(const std::string& name) const;`
  - è¯´æ˜ï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŒ‡å®šåç§°çš„å·¥ä½œè¡¨
- `std::shared_ptr<Worksheet> findSheet(const std::string& name);`
  - è¯´æ˜ï¼šæŸ¥æ‰¾å·¥ä½œè¡¨ï¼ˆå¯èƒ½ä¸å­˜åœ¨ï¼‰
- `std::shared_ptr<const Worksheet> findSheet(const std::string& name) const;`
  - è¯´æ˜ï¼šæŸ¥æ‰¾å·¥ä½œè¡¨ï¼ˆåªè¯»ç‰ˆæœ¬ï¼‰
- `std::vector<std::shared_ptr<Worksheet>> getAllSheets();`
  - è¯´æ˜ï¼šè·å–æ‰€æœ‰å·¥ä½œè¡¨
- `std::vector<std::shared_ptr<const Worksheet>> getAllSheets() const;`
  - è¯´æ˜ï¼šè·å–æ‰€æœ‰å·¥ä½œè¡¨ï¼ˆåªè¯»ç‰ˆæœ¬ï¼‰
- `int clearAllSheets();`
  - è¯´æ˜ï¼šæ¸…ç©ºæ‰€æœ‰å·¥ä½œè¡¨
- `bool renameSheet(const std::string& old_name, const std::string& new_name);`
  - è¯´æ˜ï¼šé‡å‘½åå·¥ä½œè¡¨
- `bool moveSheet(size_t from_index, size_t to_index);`
  - è¯´æ˜ï¼šç§»åŠ¨å·¥ä½œè¡¨
- `std::shared_ptr<Worksheet> copyWorksheet(const std::string& source_name, const std::string& new_name);`
  - è¯´æ˜ï¼šå¤åˆ¶å·¥ä½œè¡¨
- `std::shared_ptr<Worksheet> copyWorksheetFrom(const std::shared_ptr<const Worksheet>& source_worksheet, const std::string& new_name = "");`
  - è¯´æ˜ï¼šå¤åˆ¶å·¥ä½œè¡¨ä»å¦ä¸€ä¸ªå·¥ä½œç°¿
- `void setActiveWorksheet(size_t index);`
  - è¯´æ˜ï¼šè®¾ç½®æ´»åŠ¨å·¥ä½œè¡¨
- `std::shared_ptr<Worksheet> getActiveWorksheet();`
  - è¯´æ˜ï¼šè·å–æ´»åŠ¨å·¥ä½œè¡¨
- `std::shared_ptr<const Worksheet> getActiveWorksheet() const;`
  - è¯´æ˜ï¼šè·å–æ´»åŠ¨å·¥ä½œè¡¨ï¼ˆåªè¯»ï¼‰
- `// ğŸš€ æ–°APIï¼šä¾¿æ·çš„å•å…ƒæ ¼è®¿é—®æ–¹æ³•ï¼ˆè·¨å·¥ä½œè¡¨ï¼‰ template<typename T> T getValue(size_t sheet_index, int row, int col) const { auto worksheet = getSheet(sheet_index);`
  - è¯´æ˜ï¼šé€šè¿‡å·¥ä½œè¡¨ç´¢å¼•å’Œå•å…ƒæ ¼åæ ‡è·å–å€¼
- `if (!worksheet) { throw std::runtime_error("Invalid worksheet index: " + std::to_string(sheet_index));`
- `} return worksheet->getValue<T>(row, col);`
- `} template<typename T> void setValue(const std::string& sheet_name, int row, int col, const T& value) { auto worksheet = getSheet(sheet_name);`
  - è¯´æ˜ï¼šé€šè¿‡å·¥ä½œè¡¨åç§°å’Œå•å…ƒæ ¼åæ ‡è®¾ç½®å€¼
- `if (!worksheet) { throw std::runtime_error("Worksheet not found: " + sheet_name);`
- `} worksheet->setValue<T>(row, col, value);`
- `} template<typename T> void setValue(size_t sheet_index, int row, int col, const T& value) { auto worksheet = getSheet(sheet_index);`
  - è¯´æ˜ï¼šé€šè¿‡å·¥ä½œè¡¨ç´¢å¼•å’Œå•å…ƒæ ¼åæ ‡è®¾ç½®å€¼
- `if (!worksheet) { throw std::runtime_error("Invalid worksheet index: " + std::to_string(sheet_index));`
- `} worksheet->setValue<T>(row, col, value);`
- `} // ğŸš€ æ–°APIï¼šå®‰å…¨ç‰ˆæœ¬çš„è·¨å·¥ä½œè¡¨è®¿é—®æ–¹æ³•ï¼ˆä¸æŠ›å¼‚å¸¸ï¼‰ std::optional<std::shared_ptr<Worksheet>> tryGetSheet(const std::string& name) noexcept { try { auto sheet = findSheet(name);`
  - è¯´æ˜ï¼šå®‰å…¨è·å–å·¥ä½œè¡¨æŒ‡é’ˆ
- `return sheet ? std::make_optional(sheet) : std::nullopt;`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<std::shared_ptr<Worksheet>> tryGetSheet(size_t index) noexcept { try { auto sheet = getSheet(index);`
  - è¯´æ˜ï¼šå®‰å…¨è·å–å·¥ä½œè¡¨æŒ‡é’ˆï¼ˆç´¢å¼•ç‰ˆæœ¬ï¼‰
- `return sheet ? std::make_optional(sheet) : std::nullopt;`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> std::optional<T> tryGetValue(const std::string& sheet_name, int row, int col) const noexcept { try { auto worksheet = findSheet(sheet_name);`
  - è¯´æ˜ï¼šå®‰å…¨è·å–å•å…ƒæ ¼å€¼ï¼ˆé€šè¿‡å·¥ä½œè¡¨åç§°ï¼‰
- `if (!worksheet) { return std::nullopt;`
- `} return worksheet->tryGetValue<T>(row, col);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> std::optional<T> tryGetValue(size_t sheet_index, int row, int col) const noexcept { try { if (sheet_index >= worksheets_.size()) { return std::nullopt;`
  - è¯´æ˜ï¼šå®‰å…¨è·å–å•å…ƒæ ¼å€¼ï¼ˆé€šè¿‡å·¥ä½œè¡¨ç´¢å¼•ï¼‰
- `if (!worksheet) { return std::nullopt;`
- `} return worksheet->tryGetValue<T>(row, col);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> bool trySetValue(const std::string& sheet_name, int row, int col, const T& value) noexcept { try { auto worksheet = findSheet(sheet_name);`
  - è¯´æ˜ï¼šå®‰å…¨è®¾ç½®å•å…ƒæ ¼å€¼ï¼ˆé€šè¿‡å·¥ä½œè¡¨åç§°ï¼‰
- `if (!worksheet) { return false;`
- `} worksheet->setValue<T>(row, col, value);`
- `} catch (...) { return false;`
- `} } template<typename T> T getValue(const std::string& full_address) const { auto [sheet_name, row, col] = utils::AddressParser::parseAddress(full_address);`
  - è¯´æ˜ï¼šé€šè¿‡å®Œæ•´åœ°å€å­—ç¬¦ä¸²è®¿é—®å•å…ƒæ ¼ï¼ˆæ”¯æŒè·¨å·¥ä½œè¡¨ï¼‰
- `if (sheet_name.empty()) { // å¦‚æœæ²¡æœ‰å·¥ä½œè¡¨åï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ return getValue<T>(0, row, col);`
- `} auto worksheet = getSheet(sheet_name);`
- `if (!worksheet) { throw std::runtime_error("Worksheet not found: " + sheet_name);`
- `} return worksheet->getValue<T>(row, col);`
- `} template<typename T> void setValue(const std::string& full_address, const T& value) { auto [sheet_name, row, col] = utils::AddressParser::parseAddress(full_address);`
  - è¯´æ˜ï¼šé€šè¿‡å®Œæ•´åœ°å€å­—ç¬¦ä¸²è®¾ç½®å•å…ƒæ ¼å€¼ï¼ˆæ”¯æŒè·¨å·¥ä½œè¡¨ï¼‰
- `if (sheet_name.empty()) { // å¦‚æœæ²¡æœ‰å·¥ä½œè¡¨åï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ setValue<T>(0, row, col, value);`
- `} auto worksheet = getSheet(sheet_name);`
- `if (!worksheet) { throw std::runtime_error("Worksheet not found: " + sheet_name);`
- `} worksheet->setValue<T>(row, col, value);`
- `} // ========== æ ·å¼ç®¡ç† ========== int addStyle(const FormatDescriptor& style);`
  - è¯´æ˜ï¼šæ·»åŠ æ ·å¼åˆ°å·¥ä½œç°¿
- `int addStyle(const StyleBuilder& builder);`
  - è¯´æ˜ï¼šæ·»åŠ æ ·å¼åˆ°å·¥ä½œç°¿ï¼ˆä½¿ç”¨Builderï¼‰
- `int addNamedStyle(const NamedStyle& named_style);`
  - è¯´æ˜ï¼šæ·»åŠ å‘½åæ ·å¼
- `StyleBuilder createStyleBuilder() const;`
  - è¯´æ˜ï¼šåˆ›å»ºæ ·å¼æ„å»ºå™¨
- `std::shared_ptr<const FormatDescriptor> getStyle(int style_id) const;`
  - è¯´æ˜ï¼šæ ¹æ®IDè·å–æ ·å¼
- `int getDefaultStyleId() const;`
  - è¯´æ˜ï¼šè·å–é»˜è®¤æ ·å¼ID
- `bool isValidStyleId(int style_id) const;`
  - è¯´æ˜ï¼šæ£€æŸ¥æ ·å¼IDæ˜¯å¦æœ‰æ•ˆ
- `size_t getStyleCount() const;`
  - è¯´æ˜ï¼šè·å–æ ·å¼æ•°é‡
- `const FormatRepository& getStyles() const;`
  - è¯´æ˜ï¼šè·å–æ ·å¼ä»“å‚¨ï¼ˆåªè¯»è®¿é—®ï¼‰
- `void setThemeXML(const std::string& theme_xml);`
  - è¯´æ˜ï¼šè®¾ç½®è‡ªå®šä¹‰ä¸»é¢˜XML
- `void setOriginalThemeXML(const std::string& theme_xml);`
  - è¯´æ˜ï¼šè®¾ç½®åŸå§‹ä¸»é¢˜XMLï¼ˆä»…ä¾›è¯»å–å™¨ä½¿ç”¨ï¼Œä¿æŒä¿çœŸï¼‰
- `void setTheme(const theme::Theme& theme);`
  - è¯´æ˜ï¼šè®¾ç½®ä¸»é¢˜ï¼ˆç»“æ„åŒ–å¯¹è±¡ï¼‰
- `const theme::Theme* getTheme() const { return theme_.get(); } void setThemeName(const std::string& name);`
  - è¯´æ˜ï¼šè®¾ç½®ä¸»é¢˜åç§°
- `void setThemeColor(theme::ThemeColorScheme::ColorType type, const core::Color& color);`
  - è¯´æ˜ï¼šé€šè¿‡ç±»å‹è®¾ç½®ä¸»é¢˜é¢œè‰²
- `bool setThemeColorByName(const std::string& name, const core::Color& color);`
  - è¯´æ˜ï¼šé€šè¿‡åç§°è®¾ç½®ä¸»é¢˜é¢œè‰²ï¼ˆå¦‚ "accent1"/"lt1"/"hlink" ç­‰ï¼‰
- `void setThemeMajorFontLatin(const std::string& name);`
  - è¯´æ˜ï¼šè®¾ç½®ä¸»é¢˜çš„majorå­—ä½“æ—
- `void setThemeMajorFontEastAsia(const std::string& name);`
- `void setThemeMajorFontComplex(const std::string& name);`
- `void setThemeMinorFontLatin(const std::string& name);`
  - è¯´æ˜ï¼šè®¾ç½®ä¸»é¢˜çš„minorå­—ä½“æ—
- `void setThemeMinorFontEastAsia(const std::string& name);`
- `void setThemeMinorFontComplex(const std::string& name);`
- `const std::string& getThemeXML() const;`
  - è¯´æ˜ï¼šè·å–å½“å‰ä¸»é¢˜XML
- `std::unique_ptr<StyleTransferContext> copyStylesFrom( const Workbook& source_workbook);`
  - è¯´æ˜ï¼šä»å¦ä¸€ä¸ªå·¥ä½œç°¿å¤åˆ¶æ ·å¼
- `FormatRepository::DeduplicationStats getStyleStats() const;`
  - è¯´æ˜ï¼šè·å–æ ·å¼å»é‡ç»Ÿè®¡
- `// ========== æ–‡æ¡£å±æ€§ ========== void setTitle(const std::string& title) { doc_properties_.title = title; } const std::string& getTitle() const { return doc_properties_.title; } void setSubject(const std::string& subject) { doc_properties_.subject = subject; } const std::string& getSubject() const { return doc_properties_.subject; } void setAuthor(const std::string& author) { doc_properties_.author = author; } const std::string& getAuthor() const { return doc_properties_.author; } void setManager(const std::string& manager) { doc_properties_.manager = manager; } void setCompany(const std::string& company) { doc_properties_.company = company; } void setCategory(const std::string& category) { doc_properties_.category = category; } void setKeywords(const std::string& keywords) { doc_properties_.keywords = keywords; } void setComments(const std::string& comments) { doc_properties_.comments = comments; } void setStatus(const std::string& status) { doc_properties_.status = status; } void setHyperlinkBase(const std::string& hyperlink_base) { doc_properties_.hyperlink_base = hyperlink_base; } void setCreatedTime(const std::tm& created_time) { doc_properties_.created_time = created_time; } void setModifiedTime(const std::tm& modified_time) { doc_properties_.modified_time = modified_time; } void setDocumentProperties(const std::string& title = "", const std::string& subject = "", const std::string& author = "", const std::string& company = "", const std::string& comments = "");`
  - è¯´æ˜ï¼šæ‰¹é‡è®¾ç½®æ–‡æ¡£å±æ€§ï¼ˆæ–°APIï¼‰
- `void setApplication(const std::string& application);`
  - è¯´æ˜ï¼šè®¾ç½®åº”ç”¨ç¨‹åºåç§°ï¼ˆæ–°APIï¼‰
- `// ========== è‡ªå®šä¹‰å±æ€§ ========== void setProperty(const std::string& name, const std::string& value);`
  - è¯´æ˜ï¼šæ·»åŠ è‡ªå®šä¹‰å±æ€§ï¼ˆå­—ç¬¦ä¸²ï¼‰
- `void setProperty(const std::string& name, double value);`
  - è¯´æ˜ï¼šæ·»åŠ è‡ªå®šä¹‰å±æ€§ï¼ˆæ•°å­—ï¼‰
- `void setProperty(const std::string& name, bool value);`
  - è¯´æ˜ï¼šæ·»åŠ è‡ªå®šä¹‰å±æ€§ï¼ˆå¸ƒå°”ï¼‰
- `std::string getProperty(const std::string& name) const;`
  - è¯´æ˜ï¼šè·å–è‡ªå®šä¹‰å±æ€§
- `bool removeProperty(const std::string& name);`
  - è¯´æ˜ï¼šåˆ é™¤è‡ªå®šä¹‰å±æ€§
- `std::unordered_map<std::string, std::string> getAllProperties() const;`
  - è¯´æ˜ï¼šè·å–æ‰€æœ‰è‡ªå®šä¹‰å±æ€§
- `// ========== å®šä¹‰åç§° ========== void defineName(const std::string& name, const std::string& formula, const std::string& scope = "");`
  - è¯´æ˜ï¼šå®šä¹‰åç§°
- `std::string getDefinedName(const std::string& name, const std::string& scope = "") const;`
  - è¯´æ˜ï¼šè·å–å®šä¹‰åç§°çš„å…¬å¼
- `bool removeDefinedName(const std::string& name, const std::string& scope = "");`
  - è¯´æ˜ï¼šåˆ é™¤å®šä¹‰åç§°
- `// ========== VBAé¡¹ç›® ========== bool addVbaProject(const std::string& vba_project_path);`
  - è¯´æ˜ï¼šæ·»åŠ VBAé¡¹ç›®
- `bool hasVbaProject() const { return has_vba_; } // ========== å·¥ä½œç°¿ä¿æŠ¤ ========== void protect(const std::string& password = "", bool lock_structure = true, bool lock_windows = false);`
  - è¯´æ˜ï¼šä¿æŠ¤å·¥ä½œç°¿
- `void unprotect();`
  - è¯´æ˜ï¼šå–æ¶ˆä¿æŠ¤
- `bool isProtected() const { return protected_; } // ========== å·¥ä½œç°¿é€‰é¡¹ ========== void setConstantMemory(bool constant_memory) { options_.constant_memory = constant_memory; } void setTmpDir(const std::string& tmpdir) { options_.tmpdir = tmpdir; } void setReadOnlyRecommended(bool read_only_recommended) { options_.read_only_recommended = read_only_recommended; } void setCalcOptions(bool calc_on_load, bool full_calc_on_load = false);`
  - è¯´æ˜ï¼šè®¾ç½®è®¡ç®—é€‰é¡¹
- `void setUseSharedStrings(bool enable) { options_.use_shared_strings = enable; } void setMode(WorkbookMode mode) { options_.mode = mode;`
  - è¯´æ˜ï¼šè®¾ç½®å·¥ä½œç°¿æ¨¡å¼
- `} WorkbookMode getMode() const { return options_.mode; } void setAutoModeThresholds(size_t cell_threshold, size_t memory_threshold) { options_.auto_mode_cell_threshold = cell_threshold;`
  - è¯´æ˜ï¼šè®¾ç½®è‡ªåŠ¨æ¨¡å¼é˜ˆå€¼
- `} void setRowBufferSize(size_t size) { options_.row_buffer_size = size; } void setCompressionLevel(int level) { options_.compression_level = level; } void setXMLBufferSize(size_t size) { options_.xml_buffer_size = size; } void setHighPerformanceMode(bool enable);`
  - è¯´æ˜ï¼šå¯ç”¨é«˜æ€§èƒ½æ¨¡å¼ï¼ˆè‡ªåŠ¨é…ç½®æœ€ä½³æ€§èƒ½å‚æ•°ï¼‰
- `// ========== è·å–çŠ¶æ€ ========== // è·å–è„æ•°æ®ç®¡ç†å™¨ DirtyManager* getDirtyManager() { return dirty_manager_.get(); } const DirtyManager* getDirtyManager() const { return dirty_manager_.get(); } // ç”Ÿæˆæ§åˆ¶ï¼ˆåŸºäºDirtyManagerçš„æ–°å®ç°ï¼‰ bool shouldGenerateContentTypes() const;`
- `bool shouldGenerateRootRels() const;`
- `bool shouldGenerateWorkbookCore() const;`
- `bool shouldGenerateStyles() const;`
- `bool shouldGenerateTheme() const;`
- `bool shouldGenerateSharedStrings() const;`
- `bool shouldGenerateDocPropsCore() const;`
- `bool shouldGenerateDocPropsApp() const;`
- `bool shouldGenerateDocPropsCustom() const;`
- `bool shouldGenerateSheet(size_t index) const;`
- `bool shouldGenerateSheetRels(size_t index) const;`
- `bool isReadOnly() const { return state_ == WorkbookState::READING; } bool isEditable() const { return state_ == WorkbookState::EDITING || state_ == WorkbookState::CREATING; } const std::string& getFilename() const { return filename_; } const DocumentProperties& getDocumentProperties() const { return doc_properties_; } WorkbookOptions& getOptions() { return options_; } const WorkbookOptions& getOptions() const { return options_; } // ========== å…±äº«å­—ç¬¦ä¸²ç®¡ç† ========== int addSharedString(const std::string& str);`
  - è¯´æ˜ï¼šæ·»åŠ å…±äº«å­—ç¬¦ä¸²
- `int addSharedStringWithIndex(const std::string& str, int original_index);`
  - è¯´æ˜ï¼šæ·»åŠ å…±äº«å­—ç¬¦ä¸²å¹¶ä¿æŒåŸå§‹ç´¢å¼•ï¼ˆç”¨äºæ–‡ä»¶å¤åˆ¶ï¼‰
- `int getSharedStringIndex(const std::string& str) const;`
  - è¯´æ˜ï¼šè·å–å…±äº«å­—ç¬¦ä¸²ç´¢å¼•
- `const SharedStringTable* getSharedStrings() const;`
  - è¯´æ˜ï¼šè·å–å…±äº«å­—ç¬¦ä¸²è¡¨
- `// ========== å·¥ä½œç°¿ç¼–è¾‘åŠŸèƒ½ ========== static std::unique_ptr<Workbook> open(const Path& path);`
  - è¯´æ˜ï¼šæ‰“å¼€ç°æœ‰æ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼ˆç›´æ¥å¯ç”¨ï¼Œæ— éœ€å†è°ƒç”¨openï¼‰
- `bool refresh();`
  - è¯´æ˜ï¼šåˆ·æ–°å·¥ä½œç°¿ï¼ˆé‡æ–°è¯»å–æ–‡ä»¶å†…å®¹ï¼‰
- `bool mergeWorkbook(const std::unique_ptr<Workbook>& other_workbook, const MergeOptions& options = {});`
  - è¯´æ˜ï¼šåˆå¹¶å¦ä¸€ä¸ªå·¥ä½œç°¿çš„å†…å®¹
- `bool exportWorksheets(const std::vector<std::string>& worksheet_names, const std::string& output_filename);`
  - è¯´æ˜ï¼šå¯¼å‡ºå·¥ä½œè¡¨åˆ°æ–°å·¥ä½œç°¿
- `int batchRenameWorksheets(const std::unordered_map<std::string, std::string>& rename_map);`
  - è¯´æ˜ï¼šæ‰¹é‡é‡å‘½åå·¥ä½œè¡¨
- `int batchRemoveWorksheets(const std::vector<std::string>& worksheet_names);`
  - è¯´æ˜ï¼šæ‰¹é‡åˆ é™¤å·¥ä½œè¡¨
- `bool reorderWorksheets(const std::vector<std::string>& new_order);`
  - è¯´æ˜ï¼šé‡æ–°æ’åºå·¥ä½œè¡¨
- `int findAndReplaceAll(const std::string& find_text, const std::string& replace_text, const FindReplaceOptions& options = {});`
  - è¯´æ˜ï¼šæŸ¥æ‰¾å¹¶æ›¿æ¢ï¼ˆå…¨å·¥ä½œç°¿ï¼‰
- `std::vector<std::tuple<std::string, int, int>> findAll(const std::string& search_text, const FindReplaceOptions& options = {});`
  - è¯´æ˜ï¼šå…¨å±€æŸ¥æ‰¾
- `WorkbookStats getStatistics() const;`
  - è¯´æ˜ï¼šè·å–å·¥ä½œç°¿ç»Ÿè®¡ä¿¡æ¯
- `bool isModified() const;`
  - è¯´æ˜ï¼šæ£€æŸ¥å·¥ä½œç°¿æ˜¯å¦å·²ä¿®æ”¹ï¼ˆæ–°APIï¼‰
- `size_t getTotalMemoryUsage() const;`
  - è¯´æ˜ï¼šè·å–å†…å­˜ä½¿ç”¨æ€»é‡ï¼ˆæ–°APIï¼‰
- `size_t optimize();`
  - è¯´æ˜ï¼šä¼˜åŒ–å·¥ä½œç°¿ï¼ˆå‹ç¼©æ ·å¼ã€æ¸…ç†æœªä½¿ç”¨èµ„æºï¼Œæ–°APIï¼‰

## Worksheet

Worksheetç±» - Excelå·¥ä½œè¡¨

_Declared in: `src/fastexcel/core/Worksheet.hpp`_

- `explicit Worksheet(const std::string& name, std::shared_ptr<Workbook> workbook, int sheet_id = 1);`
- `~Worksheet() = default;`
- `// ç¦ç”¨æ‹·è´æ„é€ å’Œèµ‹å€¼ Worksheet(const Worksheet&) = delete;`
- `Worksheet& operator=(const Worksheet&) = delete;`
- `// å…è®¸ç§»åŠ¨æ„é€ å’Œèµ‹å€¼ Worksheet(Worksheet&&) = default;`
- `Worksheet& operator=(Worksheet&&) = default;`
- `// ========== ä¼˜åŒ–åŠŸèƒ½ ========== void setSharedStringTable(SharedStringTable* sst) { sst_ = sst; } void setFormatRepository(FormatRepository* format_repo) { format_repo_ = format_repo; } void setOptimizeMode(bool enable);`
  - è¯´æ˜ï¼šå¯ç”¨/ç¦ç”¨ä¼˜åŒ–æ¨¡å¼
- `bool isOptimizeMode() const { return optimize_mode_; } void flushCurrentRow();`
  - è¯´æ˜ï¼šåˆ·æ–°å½“å‰è¡Œç¼“å­˜
- `size_t getMemoryUsage() const;`
  - è¯´æ˜ï¼šè·å–å†…å­˜ä½¿ç”¨æƒ…å†µ
- `PerformanceStats getPerformanceStats() const;`
  - è¯´æ˜ï¼šè·å–æ€§èƒ½ç»Ÿè®¡ä¿¡æ¯
- `// ========== åŸºæœ¬å•å…ƒæ ¼æ“ä½œ ========== Cell& getCell(int row, int col);`
  - è¯´æ˜ï¼šè·å–å•å…ƒæ ¼å¼•ç”¨
- `const Cell& getCell(int row, int col) const;`
- `// ğŸš€ æ–°APIï¼šæ¨¡æ¿åŒ–çš„å•å…ƒæ ¼å€¼è·å–å’Œè®¾ç½® template<typename T> T getValue(int row, int col) const { return getCell(row, col).getValue<T>();`
  - è¯´æ˜ï¼šæ¨¡æ¿åŒ–è·å–å•å…ƒæ ¼å€¼
- `} template<typename T> void setValue(int row, int col, const T& value) { getCell(row, col).setValue<T>(value);`
  - è¯´æ˜ï¼šæ¨¡æ¿åŒ–è®¾ç½®å•å…ƒæ ¼å€¼
- `} template<typename T> void setCellValue(int row, int col, const T& value) { setValue<T>(row, col, value);`
  - è¯´æ˜ï¼šsetCellValue - setValueçš„è¯­ä¹‰åŒ–åˆ«å
- `} // ğŸš€ æ™ºèƒ½å•å…ƒæ ¼æ ¼å¼è®¾ç½® API - è¯­ä¹‰æ˜ç¡®ï¼ void setCellFormat(int row, int col, const core::FormatDescriptor& format);`
  - è¯´æ˜ï¼šè®¾ç½®å•å…ƒæ ¼æ ¼å¼ï¼ˆæ™ºèƒ½ä¼˜åŒ–ç‰ˆï¼‰
- `void setCellFormat(int row, int col, std::shared_ptr<const core::FormatDescriptor> format);`
- `void setCellFormat(int row, int col, const core::StyleBuilder& builder);`
- `// ========== èŒƒå›´æ ¼å¼åŒ–API ========== RangeFormatter rangeFormatter(const std::string& range);`
  - è¯´æ˜ï¼šåˆ›å»ºèŒƒå›´æ ¼å¼åŒ–å™¨
- `RangeFormatter rangeFormatter(int start_row, int start_col, int end_row, int end_col);`
  - è¯´æ˜ï¼šåˆ›å»ºèŒƒå›´æ ¼å¼åŒ–å™¨ï¼ˆåæ ‡ç‰ˆæœ¬ï¼‰
- `std::optional<std::shared_ptr<const FormatDescriptor>> tryGetCellFormat(int row, int col) const noexcept { try { if (!hasCellAt(row, col)) { return std::nullopt;`
  - è¯´æ˜ï¼šå®‰å…¨è·å–å•å…ƒæ ¼æ ¼å¼
- `} const auto& cell = getCell(row, col);`
- `auto format = cell.getFormatDescriptor();`
- `return format ? std::make_optional(format) : std::nullopt;`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<double> tryGetColumnWidth(int col) const noexcept { try { if (col < 0) return std::nullopt;`
  - è¯´æ˜ï¼šå®‰å…¨è·å–åˆ—å®½
- `return std::make_optional(getColumnWidth(col));`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<double> tryGetRowHeight(int row) const noexcept { try { if (row < 0) return std::nullopt;`
  - è¯´æ˜ï¼šå®‰å…¨è·å–è¡Œé«˜
- `return std::make_optional(getRowHeight(row));`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<std::pair<int, int>> tryGetUsedRange() const noexcept { try { auto range = getUsedRange();`
  - è¯´æ˜ï¼šå®‰å…¨è·å–ä½¿ç”¨èŒƒå›´
- `if (range.first == -1 || range.second == -1) { return std::nullopt;`
- `} return std::make_optional(range);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> std::optional<T> tryGetValue(int row, int col) const noexcept { if (!hasCellAt(row, col)) { return std::nullopt;`
  - è¯´æ˜ï¼šå®‰å…¨è·å–å•å…ƒæ ¼å€¼ï¼ˆä¸æŠ›å¼‚å¸¸ï¼‰
- `} return getCell(row, col).tryGetValue<T>();`
- `} template<typename T> T getValueOr(int row, int col, const T& default_value) const noexcept { if (!hasCellAt(row, col)) { return default_value;`
  - è¯´æ˜ï¼šè·å–å•å…ƒæ ¼å€¼æˆ–é»˜è®¤å€¼
- `} return getCell(row, col).getValueOr<T>(default_value);`
- `} // ğŸš€ æ–°APIï¼šExcelåœ°å€æ ¼å¼æ”¯æŒ template<typename T> T getValue(const std::string& address) const { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - è¯´æ˜ï¼šé€šè¿‡Excelåœ°å€è·å–å•å…ƒæ ¼å€¼
- `return getValue<T>(row, col);`
- `} template<typename T> void setValue(const std::string& address, const T& value) { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - è¯´æ˜ï¼šé€šè¿‡Excelåœ°å€è®¾ç½®å•å…ƒæ ¼å€¼
- `setValue<T>(row, col, value);`
- `} template<typename T> void setCellValue(const std::string& address, const T& value) { setValue<T>(address, value);`
  - è¯´æ˜ï¼šsetCellValue - setValueçš„è¯­ä¹‰åŒ–åˆ«åï¼ˆå­—ç¬¦ä¸²åœ°å€ç‰ˆæœ¬ï¼‰
- `} template<typename T> std::optional<T> tryGetValue(const std::string& address) const noexcept { try { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - è¯´æ˜ï¼šé€šè¿‡Excelåœ°å€å®‰å…¨è·å–å•å…ƒæ ¼å€¼
- `return tryGetValue<T>(row, col);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> T getValueOr(const std::string& address, const T& default_value) const noexcept { try { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - è¯´æ˜ï¼šé€šè¿‡Excelåœ°å€è·å–å•å…ƒæ ¼å€¼æˆ–é»˜è®¤å€¼
- `return getValueOr<T>(row, col, default_value);`
- `} catch (...) { return default_value;`
- `} } void writeDateTime(int row, int col, const std::tm& datetime);`
  - è¯´æ˜ï¼šå†™å…¥æ—¥æœŸæ—¶é—´
- `void writeUrl(int row, int col, const std::string& url, const std::string& string = "");`
  - è¯´æ˜ï¼šå†™å…¥URLé“¾æ¥
- `// ========== æ‰¹é‡æ•°æ®æ“ä½œ ========== // ğŸš€ æ–°APIï¼šæ¨¡æ¿åŒ–èŒƒå›´æ“ä½œ template<typename T> std::vector<std::vector<T>> getRange(int start_row, int start_col, int end_row, int end_col) const { std::vector<std::vector<T>> result;`
  - è¯´æ˜ï¼šè·å–èŒƒå›´å†…çš„æ‰€æœ‰å€¼
- `result.reserve(end_row - start_row + 1);`
- `for (int row = start_row; row <= end_row; ++row) { std::vector<T> row_data;`
- `row_data.reserve(end_col - start_col + 1);`
- `for (int col = start_col; col <= end_col; ++col) { if (hasCellAt(row, col)) { row_data.push_back(getCell(row, col).getValue<T>());`
- `} else { // ç©ºå•å…ƒæ ¼è¿”å›é»˜è®¤å€¼ if constexpr (std::is_same_v<T, std::string>) { row_data.push_back("");`
- `} else if constexpr (std::is_arithmetic_v<T>) { row_data.push_back(static_cast<T>(0));`
- `} else if constexpr (std::is_same_v<T, bool>) { row_data.push_back(false);`
- `} } } result.push_back(std::move(row_data));`
- `} template<typename T> std::vector<std::vector<T>> getRange(const std::string& range) const { auto [sheet, start_row, start_col, end_row, end_col] = utils::AddressParser::parseRange(range);`
  - è¯´æ˜ï¼šé€šè¿‡Excelåœ°å€è·å–èŒƒå›´å†…çš„æ‰€æœ‰å€¼
- `return getRange<T>(start_row, start_col, end_row, end_col);`
- `} template<typename T> void setRange(int start_row, int start_col, const std::vector<std::vector<T>>& data) { for (size_t row_idx = 0; row_idx < data.size(); ++row_idx) { for (size_t col_idx = 0; col_idx < data[row_idx].size(); ++col_idx) { int target_row = static_cast<int>(start_row + row_idx);`
  - è¯´æ˜ï¼šè®¾ç½®èŒƒå›´å†…çš„æ‰€æœ‰å€¼
- `int target_col = static_cast<int>(start_col + col_idx);`
- `setValue<T>(target_row, target_col, data[row_idx][col_idx]);`
- `} } } template<typename T> void setRange(const std::string& range, const std::vector<std::vector<T>>& data) { auto [sheet, start_row, start_col, end_row, end_col] = utils::AddressParser::parseRange(range);`
  - è¯´æ˜ï¼šé€šè¿‡Excelåœ°å€è®¾ç½®èŒƒå›´å†…çš„æ‰€æœ‰å€¼
- `setRange<T>(start_row, start_col, data);`
- `} // ğŸš€ æ–°APIï¼šé“¾å¼è°ƒç”¨æ”¯æŒ WorksheetChain chain();`
  - è¯´æ˜ï¼šè·å–é“¾å¼è°ƒç”¨å¯¹è±¡
- `// ========== è¡Œåˆ—æ“ä½œ ========== void setColumnWidth(int col, double width);`
  - è¯´æ˜ï¼šè®¾ç½®åˆ—å®½
- `void setColumnWidth(int first_col, int last_col, double width);`
  - è¯´æ˜ï¼šè®¾ç½®åˆ—å®½èŒƒå›´
- `void setColumnFormatId(int col, int format_id);`
  - è¯´æ˜ï¼šè®¾ç½®åˆ—æ ¼å¼
- `void setColumnFormatId(int first_col, int last_col, int format_id);`
  - è¯´æ˜ï¼šè®¾ç½®åˆ—æ ¼å¼èŒƒå›´
- `void setColumnFormat(int col, std::shared_ptr<Format> format);`
  - è¯´æ˜ï¼šè®¾ç½®åˆ—æ ¼å¼
- `void setColumnFormat(int first_col, int last_col, std::shared_ptr<Format> format);`
  - è¯´æ˜ï¼šè®¾ç½®åˆ—æ ¼å¼èŒƒå›´
- `void hideColumn(int col);`
  - è¯´æ˜ï¼šéšè—åˆ—
- `void hideColumn(int first_col, int last_col);`
  - è¯´æ˜ï¼šéšè—åˆ—èŒƒå›´
- `void setRowHeight(int row, double height);`
  - è¯´æ˜ï¼šè®¾ç½®è¡Œé«˜
- `void setRowFormat(int row, std::shared_ptr<Format> format);`
  - è¯´æ˜ï¼šè®¾ç½®è¡Œæ ¼å¼
- `void hideRow(int row);`
  - è¯´æ˜ï¼šéšè—è¡Œ
- `void hideRow(int first_row, int last_row);`
  - è¯´æ˜ï¼šéšè—è¡ŒèŒƒå›´
- `// ========== åˆå¹¶å•å…ƒæ ¼ ========== void mergeCells(int first_row, int first_col, int last_row, int last_col);`
  - è¯´æ˜ï¼šåˆå¹¶å•å…ƒæ ¼
- `// ========== è‡ªåŠ¨ç­›é€‰ ========== void setAutoFilter(int first_row, int first_col, int last_row, int last_col);`
  - è¯´æ˜ï¼šè®¾ç½®è‡ªåŠ¨ç­›é€‰
- `void removeAutoFilter();`
  - è¯´æ˜ï¼šç§»é™¤è‡ªåŠ¨ç­›é€‰
- `// ========== å†»ç»“çª—æ ¼ ========== void freezePanes(int row, int col);`
  - è¯´æ˜ï¼šå†»ç»“çª—æ ¼
- `void freezePanes(int row, int col, int top_left_row, int top_left_col);`
  - è¯´æ˜ï¼šå†»ç»“çª—æ ¼ï¼ˆæŒ‡å®šå·¦ä¸Šè§’å•å…ƒæ ¼ï¼‰
- `void splitPanes(int row, int col);`
  - è¯´æ˜ï¼šåˆ†å‰²çª—æ ¼
- `// ========== æ‰“å°è®¾ç½® ========== void setPrintArea(int first_row, int first_col, int last_row, int last_col);`
  - è¯´æ˜ï¼šè®¾ç½®æ‰“å°åŒºåŸŸ
- `void setRepeatRows(int first_row, int last_row);`
  - è¯´æ˜ï¼šè®¾ç½®é‡å¤æ‰“å°è¡Œ
- `void setRepeatColumns(int first_col, int last_col);`
  - è¯´æ˜ï¼šè®¾ç½®é‡å¤æ‰“å°åˆ—
- `void setLandscape(bool landscape = true);`
  - è¯´æ˜ï¼šè®¾ç½®é¡µé¢æ–¹å‘
- `void setPaperSize(int paper_size);`
  - è¯´æ˜ï¼šè®¾ç½®çº¸å¼ å¤§å°
- `void setMargins(double left, double right, double top, double bottom);`
  - è¯´æ˜ï¼šè®¾ç½®é¡µè¾¹è·
- `void setHeaderFooterMargins(double header, double footer);`
  - è¯´æ˜ï¼šè®¾ç½®é¡µçœ‰é¡µè„šè¾¹è·
- `void setPrintScale(int scale);`
  - è¯´æ˜ï¼šè®¾ç½®æ‰“å°ç¼©æ”¾
- `void setFitToPages(int width, int height);`
  - è¯´æ˜ï¼šé€‚åˆé¡µé¢æ‰“å°
- `void setPrintGridlines(bool print = true);`
  - è¯´æ˜ï¼šè®¾ç½®æ‰“å°ç½‘æ ¼çº¿
- `void setPrintHeadings(bool print = true);`
  - è¯´æ˜ï¼šè®¾ç½®æ‰“å°æ ‡é¢˜
- `void setCenterOnPage(bool horizontal, bool vertical);`
  - è¯´æ˜ï¼šè®¾ç½®é¡µé¢å±…ä¸­
- `// ========== å·¥ä½œè¡¨ä¿æŠ¤ ========== void protect(const std::string& password = "");`
  - è¯´æ˜ï¼šä¿æŠ¤å·¥ä½œè¡¨
- `void unprotect();`
  - è¯´æ˜ï¼šå–æ¶ˆä¿æŠ¤
- `bool isProtected() const { return protected_; } // ========== è§†å›¾è®¾ç½® ========== void setZoom(int scale);`
  - è¯´æ˜ï¼šè®¾ç½®ç¼©æ”¾æ¯”ä¾‹
- `void showGridlines(bool show = true);`
  - è¯´æ˜ï¼šæ˜¾ç¤º/éšè—ç½‘æ ¼çº¿
- `void showRowColHeaders(bool show = true);`
  - è¯´æ˜ï¼šæ˜¾ç¤º/éšè—è¡Œåˆ—æ ‡é¢˜
- `void setRightToLeft(bool rtl = true);`
  - è¯´æ˜ï¼šè®¾ç½®ä»å³åˆ°å·¦æ˜¾ç¤º
- `void setTabSelected(bool selected = true);`
  - è¯´æ˜ï¼šè®¾ç½®é€‰ä¸­çŠ¶æ€
- `void setActiveCell(int row, int col);`
  - è¯´æ˜ï¼šè®¾ç½®æ´»åŠ¨å•å…ƒæ ¼
- `void setSelection(int first_row, int first_col, int last_row, int last_col);`
  - è¯´æ˜ï¼šè®¾ç½®é€‰ä¸­èŒƒå›´
- `// ========== è·å–ä¿¡æ¯ ========== const std::string& getName() const { return name_; } void setName(const std::string& name) { name_ = name; } int getSheetId() const { return sheet_id_; } std::shared_ptr<Workbook> getParentWorkbook() const { return parent_workbook_; } std::pair<int, int> getUsedRange() const;`
  - è¯´æ˜ï¼šè·å–ä½¿ç”¨èŒƒå›´
- `size_t getCellCount() const { return cells_.size(); } // ğŸš€ æ–°APIï¼šä¾¿æ·çš„å·¥ä½œè¡¨çŠ¶æ€æ£€æŸ¥æ–¹æ³• bool isEmpty() const { return cells_.empty(); } bool hasData() const { return !cells_.empty(); } int getRowCount() const;`
  - è¯´æ˜ï¼šè·å–æ€»è¡Œæ•°ï¼ˆæœ‰æ•°æ®çš„è¡Œï¼‰
- `int getColumnCount() const;`
  - è¯´æ˜ï¼šè·å–æ€»åˆ—æ•°ï¼ˆæœ‰æ•°æ®çš„åˆ—ï¼‰
- `int getCellCountInRow(int row) const;`
  - è¯´æ˜ï¼šè·å–æŒ‡å®šè¡Œçš„å•å…ƒæ ¼æ•°é‡
- `int getCellCountInColumn(int col) const;`
  - è¯´æ˜ï¼šè·å–æŒ‡å®šåˆ—çš„å•å…ƒæ ¼æ•°é‡
- `bool hasCellAt(int row, int col) const;`
  - è¯´æ˜ï¼šæ£€æŸ¥å•å…ƒæ ¼æ˜¯å¦å­˜åœ¨
- `double getColumnWidth(int col) const;`
  - è¯´æ˜ï¼šè·å–åˆ—å®½
- `double getRowHeight(int row) const;`
  - è¯´æ˜ï¼šè·å–è¡Œé«˜
- `std::shared_ptr<Format> getColumnFormat(int col) const;`
  - è¯´æ˜ï¼šè·å–åˆ—æ ¼å¼
- `std::shared_ptr<Format> getRowFormat(int row) const;`
  - è¯´æ˜ï¼šè·å–è¡Œæ ¼å¼
- `int getColumnFormatId(int col) const;`
  - è¯´æ˜ï¼šè·å–åˆ—æ ¼å¼ID
- `const std::unordered_map<int, ColumnInfo>& getColumnInfo() const { return column_info_; } bool isColumnHidden(int col) const;`
  - è¯´æ˜ï¼šæ£€æŸ¥åˆ—æ˜¯å¦éšè—
- `bool isRowHidden(int row) const;`
  - è¯´æ˜ï¼šæ£€æŸ¥è¡Œæ˜¯å¦éšè—
- `const std::vector<MergeRange>& getMergeRanges() const { return merge_ranges_; } bool hasAutoFilter() const { return autofilter_ != nullptr; } AutoFilterRange getAutoFilterRange() const;`
  - è¯´æ˜ï¼šè·å–è‡ªåŠ¨ç­›é€‰èŒƒå›´
- `bool hasFrozenPanes() const { return freeze_panes_ != nullptr; } FreezePanes getFreezeInfo() const;`
  - è¯´æ˜ï¼šè·å–å†»ç»“çª—æ ¼ä¿¡æ¯
- `AutoFilterRange getPrintArea() const;`
  - è¯´æ˜ï¼šè·å–æ‰“å°åŒºåŸŸ
- `std::pair<int, int> getRepeatRows() const;`
  - è¯´æ˜ï¼šè·å–é‡å¤è¡ŒèŒƒå›´
- `std::pair<int, int> getRepeatColumns() const;`
  - è¯´æ˜ï¼šè·å–é‡å¤åˆ—èŒƒå›´
- `bool isLandscape() const { return print_settings_.landscape; } struct Margins { double left, right, top, bottom;`
  - è¯´æ˜ï¼šè·å–é¡µè¾¹è·
- `Margins getMargins() const;`
- `int getPrintScale() const { return print_settings_.scale; } std::pair<int, int> getFitToPages() const;`
  - è¯´æ˜ï¼šè·å–é€‚åº”é¡µé¢è®¾ç½®
- `bool isPrintGridlines() const { return print_settings_.print_gridlines; } bool isPrintHeadings() const { return print_settings_.print_headings; } bool isCenterHorizontally() const { return print_settings_.center_horizontally; } bool isCenterVertically() const { return print_settings_.center_vertically; } const std::string& getProtectionPassword() const { return protection_password_; } int getZoom() const { return sheet_view_.zoom_scale; } bool isGridlinesVisible() const { return sheet_view_.show_gridlines; } bool isRowColHeadersVisible() const { return sheet_view_.show_row_col_headers; } bool isRightToLeft() const { return sheet_view_.right_to_left; } bool isTabSelected() const { return sheet_view_.tab_selected; } const std::string& getActiveCell() const { return active_cell_; } const std::string& getSelection() const { return selection_; } // ========== XMLç”Ÿæˆ ========== void generateXML(const std::function<void(const char*, size_t)>& callback) const;`
  - è¯´æ˜ï¼šç”Ÿæˆå·¥ä½œè¡¨XMLåˆ°å›è°ƒå‡½æ•°ï¼ˆä½¿ç”¨UnifiedXMLGeneratorï¼‰
- `void generateRelsXML(const std::function<void(const char*, size_t)>& callback) const;`
  - è¯´æ˜ï¼šç”Ÿæˆå·¥ä½œè¡¨å…³ç³»XMLåˆ°å›è°ƒå‡½æ•°ï¼ˆæµå¼å†™å…¥ï¼‰
- `void generateRelsXMLToFile(const std::string& filename) const;`
  - è¯´æ˜ï¼šç”Ÿæˆå·¥ä½œè¡¨å…³ç³»XMLåˆ°æ–‡ä»¶ï¼ˆæµå¼å†™å…¥ï¼‰
- `// ========== å·¥å…·æ–¹æ³• ========== void clear();`
  - è¯´æ˜ï¼šæ¸…ç©ºå·¥ä½œè¡¨
- `void clearRange(int first_row, int first_col, int last_row, int last_col);`
  - è¯´æ˜ï¼šæ¸…ç©ºæŒ‡å®šåŒºåŸŸ
- `void insertRows(int row, int count = 1);`
  - è¯´æ˜ï¼šæ’å…¥è¡Œ
- `void insertColumns(int col, int count = 1);`
  - è¯´æ˜ï¼šæ’å…¥åˆ—
- `void deleteRows(int row, int count = 1);`
  - è¯´æ˜ï¼šåˆ é™¤è¡Œ
- `void deleteColumns(int col, int count = 1);`
  - è¯´æ˜ï¼šåˆ é™¤åˆ—
- `// ========== å•å…ƒæ ¼ç¼–è¾‘åŠŸèƒ½ ========== void editCellValue(int row, int col, const std::string& value, bool preserve_format = true);`
  - è¯´æ˜ï¼šä¿®æ”¹ç°æœ‰å•å…ƒæ ¼çš„å€¼
- `void editCellValue(int row, int col, double value, bool preserve_format = true);`
- `void editCellValue(int row, int col, bool value, bool preserve_format = true);`
- `void editCellFormat(int row, int col, std::shared_ptr<Format> format);`
  - è¯´æ˜ï¼šä¿®æ”¹å•å…ƒæ ¼æ ¼å¼
- `void copyCell(int src_row, int src_col, int dst_row, int dst_col, bool copy_format = true, bool copy_row_height = false);`
  - è¯´æ˜ï¼šå¤åˆ¶å•å…ƒæ ¼
- `void moveCell(int src_row, int src_col, int dst_row, int dst_col);`
  - è¯´æ˜ï¼šç§»åŠ¨å•å…ƒæ ¼
- `void copyRange(int src_first_row, int src_first_col, int src_last_row, int src_last_col, int dst_row, int dst_col, bool copy_format = true);`
  - è¯´æ˜ï¼šå¤åˆ¶èŒƒå›´
- `void moveRange(int src_first_row, int src_first_col, int src_last_row, int src_last_col, int dst_row, int dst_col);`
  - è¯´æ˜ï¼šç§»åŠ¨èŒƒå›´
- `int findAndReplace(const std::string& find_text, const std::string& replace_text, bool match_case = false, bool match_entire_cell = false);`
  - è¯´æ˜ï¼šæŸ¥æ‰¾å¹¶æ›¿æ¢
- `std::vector<std::pair<int, int>> findCells(const std::string& search_text, bool match_case = false, bool match_entire_cell = false) const;`
  - è¯´æ˜ï¼šæŸ¥æ‰¾å•å…ƒæ ¼
- `void sortRange(int first_row, int first_col, int last_row, int last_col, int sort_column = 0, bool ascending = true, bool has_header = false);`
  - è¯´æ˜ï¼šæ’åºèŒƒå›´
- `// ========== å…±äº«å…¬å¼ç®¡ç† ========== int createSharedFormula(int first_row, int first_col, int last_row, int last_col, const std::string& formula);`
  - è¯´æ˜ï¼šåˆ›å»ºå…±äº«å…¬å¼
- `const SharedFormulaManager* getSharedFormulaManager() const { return shared_formula_manager_.get(); } // ğŸš€ æ–°APIï¼šä¾¿æ·çš„è¡Œåˆ—æ“ä½œæ–¹æ³• template<typename T> int appendRow(const std::vector<T>& data) { auto [max_row, max_col] = getUsedRange();`
  - è¯´æ˜ï¼šè¿½åŠ è¡Œæ•°æ®
- `for (size_t i = 0; i < data.size(); ++i) { setValue(new_row, static_cast<int>(i), data[i]);`
- `} template<typename T> std::vector<T> getRowData(int row) const { std::vector<T> result;`
  - è¯´æ˜ï¼šè·å–æ•´è¡Œçš„æ•°æ®
- `auto [max_row, max_col] = getUsedRange();`
- `for (int col = 0; col <= max_col; ++col) { if (hasCellAt(row, col)) { result.push_back(getValue<T>(row, col));`
- `} else { result.push_back(T{}); // é»˜è®¤å€¼ } } return result;`
- `} template<typename T> std::vector<T> getColumnData(int col) const { std::vector<T> result;`
  - è¯´æ˜ï¼šè·å–æ•´åˆ—çš„æ•°æ®
- `auto [max_row, max_col] = getUsedRange();`
- `for (int row = 0; row <= max_row; ++row) { if (hasCellAt(row, col)) { result.push_back(getValue<T>(row, col));`
- `} else { result.push_back(T{}); // é»˜è®¤å€¼ } } return result;`
- `} void clearRow(int row);`
  - è¯´æ˜ï¼šæ¸…ç©ºæŒ‡å®šè¡Œçš„æ‰€æœ‰æ•°æ®
- `void clearColumn(int col);`
  - è¯´æ˜ï¼šæ¸…ç©ºæŒ‡å®šåˆ—çš„æ‰€æœ‰æ•°æ®
- `void clearAll();`
  - è¯´æ˜ï¼šæ¸…ç©ºæ‰€æœ‰å•å…ƒæ ¼æ•°æ®
- `template<typename T> void setRowData(int row, const std::vector<T>& data, int start_col = 0) { for (size_t i = 0; i < data.size(); ++i) { setValue(row, start_col + static_cast<int>(i), data[i]);`
  - è¯´æ˜ï¼šæ‰¹é‡è®¾ç½®è¡Œæ•°æ®
- `} } template<typename T> void setColumnData(int col, const std::vector<T>& data, int start_row = 0) { for (size_t i = 0; i < data.size(); ++i) { setValue(start_row + static_cast<int>(i), col, data[i]);`
  - è¯´æ˜ï¼šæ‰¹é‡è®¾ç½®åˆ—æ•°æ®

## fastexcel (namespace)

_Declared in: `src/fastexcel/FastExcel.hpp`_

- `inline std::string getVersion();`
- `FASTEXCEL_API void cleanup();`
  - è¯´æ˜ï¼šæ¸…ç†FastExcelåº“èµ„æº
- `FASTEXCEL_API core::StyleBuilder createStyle();`
  - è¯´æ˜ï¼šåˆ›å»ºæ ·å¼æ„å»ºå™¨

