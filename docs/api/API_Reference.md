# FastExcel API 参考

自动从头文件提取（启发式），以实际源码为准。

## 目录
- [Cell](#cell)
- [FASTEXCEL_API](#fastexcel_api)
- [NamedStyle](#namedstyle)
- [StyleBuilder](#stylebuilder)
- [Workbook](#workbook)
- [Worksheet](#worksheet)
- [fastexcel (namespace)](#fastexcel-(namespace))

## Cell

_Declared in: `src/fastexcel/core/Cell.hpp`_

- `Cell();`
- `~Cell();`
- `// 便利构造函数 explicit Cell(const std::string& value);`
- `explicit Cell(const char* value);`
- `explicit Cell(double value);`
- `explicit Cell(int value);`
- `explicit Cell(bool value);`
- `// 赋值运算（V3风格便捷API） Cell& operator=(double value);`
- `Cell& operator=(int value);`
- `Cell& operator=(bool value);`
- `Cell& operator=(const std::string& value);`
- `Cell& operator=(std::string_view value);`
- `Cell& operator=(const char* value);`
- `// 公式设置 void setFormula(const std::string& formula, double result = 0.0);`
- `// 共享公式设置 void setSharedFormula(int shared_index, double result = 0.0);`
- `void setSharedFormulaReference(int shared_index);`
- `// 获取值 CellType getType() const { // 对外API统一：InlineString也显示为String, SharedFormula显示为Formula if (flags_.type == CellType::InlineString) return CellType::String;`
- `if (flags_.type == CellType::SharedFormula) return CellType::Formula;`
- `} // 内部方法：获取真实的类型（用于测试和内部逻辑） CellType getInternalType() const { return flags_.type; } std::string getFormula() const;`
- `double getFormulaResult() const;`
- `// 共享公式获取 int getSharedFormulaIndex() const;`
- `bool isSharedFormula() const;`
- `// 格式操作 - FormatDescriptor架构 void setFormat(std::shared_ptr<const FormatDescriptor> format);`
- `std::shared_ptr<const FormatDescriptor> getFormatDescriptor() const;`
- `bool hasFormat() const { return flags_.has_format; } // 超链接操作 void setHyperlink(const std::string& url);`
- `std::string getHyperlink() const;`
- `bool hasHyperlink() const { return flags_.has_hyperlink; } // 批注（注释）操作 void setComment(const std::string& comment);`
- `std::string getComment() const;`
- `bool hasComment() const { return extended_ && extended_->comment; } // 🚀 新API：模板化的值获取和设置 template<typename T> T getValue() const { if constexpr (std::is_same_v<T, std::string>) { return getStringValue();`
- `} else if constexpr (std::is_floating_point_v<T>) { return static_cast<T>(getNumberValue());`
- `} else if constexpr (std::is_integral_v<T> && !std::is_same_v<T, bool>) { return static_cast<T>(getNumberValue());`
- `} else if constexpr (std::is_same_v<T, bool>) { return getBooleanValue();`
- `} else { static_assert(std::is_same_v<T, std::string>, "Unsupported type for Cell::getValue<T>()");`
- `} } template<typename T> void setValue(const T& value) { if constexpr (std::is_arithmetic_v<T> && !std::is_same_v<T, bool>) { setValueImpl(static_cast<double>(value));`
- `} else if constexpr (std::is_same_v<T, bool>) { setValueImpl(value);`
- `} else if constexpr (std::is_convertible_v<T, std::string>) { setValueImpl(std::string(value));`
- `} else { static_assert(std::is_arithmetic_v<T>, "Unsupported type for Cell::setValue<T>()");`
- `} } // 🚀 新API：安全访问方法 template<typename T> std::optional<T> tryGetValue() const noexcept { try { return getValue<T>();`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> T getValueOr(const T& default_value) const noexcept { return tryGetValue<T>().value_or(default_value);`
- `} // 状态检查 bool isEmpty() const { return flags_.type == CellType::Empty; } bool isNumber() const { return flags_.type == CellType::Number; } bool isString() const { return flags_.type == CellType::String || flags_.type == CellType::InlineString; } bool isBoolean() const { return flags_.type == CellType::Boolean; } bool isFormula() const { return flags_.type == CellType::Formula || flags_.type == CellType::SharedFormula; } bool isDate() const { return flags_.type == CellType::Date; } // 🚀 新API：便捷访问方法（统一命名风格） std::string asString() const { return getValue<std::string>(); } double asNumber() const { return getValue<double>(); } bool asBool() const { return getValue<bool>(); } int asInt() const { return getValue<int>(); } // 🚀 新API：安全的类型转换方法 template<typename T> bool canConvertTo() const noexcept { return tryGetValue<T>().has_value();`
  - 说明：检查是否可以转换为指定类型
- `} template<typename T> std::optional<T> safeCast() const noexcept { return tryGetValue<T>();`
  - 说明：安全类型转换
- `} // 清空 void clear();`
- `// 内存使用统计 - 调试用 size_t getMemoryUsage() const;`
- `// 移动语义优化 Cell(Cell&& other) noexcept;`
- `Cell& operator=(Cell&& other) noexcept;`
- `// 拷贝构造和赋值（保持兼容性） Cell(const Cell& other);`
- `Cell& operator=(const Cell& other);`

## FASTEXCEL_API

FastExcel异常基类(新架构)

_Declared in: `src/fastexcel/FastExcel.hpp`_

- `explicit FastExcelException(const std::string& message) : message_(message) {} const char* what() const noexcept override { return message_.c_str();`

## NamedStyle

命名样式 - 带名称的格式描述符

_Declared in: `src/fastexcel/core/StyleBuilder.hpp`_

- `NamedStyle(const std::string& name, const FormatDescriptor& format) : name_(name), format_(format) {} NamedStyle(const std::string& name, const StyleBuilder& builder) : name_(name), format_(builder.build()) {} const std::string& getName() const { return name_; } const FormatDescriptor& getFormat() const { return format_; } bool operator==(const NamedStyle& other) const { return name_ == other.name_ && format_ == other.format_;`
- `} bool operator!=(const NamedStyle& other) const { return !(*this == other);`
- `} size_t hash() const { std::hash<std::string> str_hasher;`
- `return str_hasher(name_) ^ (format_.hash() << 1);`

## StyleBuilder

样式构建器 - 流式API创建格式

_Declared in: `src/fastexcel/core/StyleBuilder.hpp`_

- `StyleBuilder() = default;`
- `// 从现有格式创建Builder（用于修改现有格式） explicit StyleBuilder(const FormatDescriptor& format);`
- `// ========== 字体设置（链式调用） ========== StyleBuilder& fontName(const std::string& name) { font_name_ = name;`
  - 说明：设置字体名称
- `} StyleBuilder& fontSize(double size) { if (size >= 1.0 && size <= 409.0) { font_size_ = size;`
  - 说明：设置字体大小
- `} StyleBuilder& font(const std::string& name, double size) { return fontName(name).fontSize(size);`
  - 说明：设置字体（名称+大小）
- `} StyleBuilder& font(const std::string& name, double size, bool is_bold) { return font(name, size).bold(is_bold);`
  - 说明：设置字体（名称+大小+粗体）
- `} StyleBuilder& fontColor(core::Color color) { font_color_ = color;`
  - 说明：设置字体颜色
- `} StyleBuilder& bold(bool is_bold = true) { bold_ = is_bold;`
  - 说明：设置粗体
- `} StyleBuilder& italic(bool is_italic = true) { italic_ = is_italic;`
  - 说明：设置斜体
- `} StyleBuilder& underline(UnderlineType type = UnderlineType::Single) { underline_ = type;`
  - 说明：设置下划线
- `} StyleBuilder& strikeout(bool is_strikeout = true) { strikeout_ = is_strikeout;`
  - 说明：设置删除线
- `} StyleBuilder& superscript(bool is_super = true) { script_ = is_super ? FontScript::Superscript : FontScript::None;`
  - 说明：设置上标
- `} StyleBuilder& subscript(bool is_sub = true) { script_ = is_sub ? FontScript::Subscript : FontScript::None;`
  - 说明：设置下标
- `} // ========== 对齐设置 ========== StyleBuilder& horizontalAlign(HorizontalAlign align) { horizontal_align_ = align;`
  - 说明：设置水平对齐
- `} StyleBuilder& verticalAlign(VerticalAlign align) { vertical_align_ = align;`
  - 说明：设置垂直对齐
- `} StyleBuilder& leftAlign() { return horizontalAlign(HorizontalAlign::Left);`
  - 说明：左对齐
- `} StyleBuilder& centerAlign() { return horizontalAlign(HorizontalAlign::Center);`
  - 说明：居中对齐
- `} StyleBuilder& rightAlign() { return horizontalAlign(HorizontalAlign::Right);`
  - 说明：右对齐
- `} StyleBuilder& vcenterAlign() { return verticalAlign(VerticalAlign::Center);`
  - 说明：垂直居中
- `} StyleBuilder& textWrap(bool wrap = true) { text_wrap_ = wrap;`
  - 说明：设置文本换行
- `} StyleBuilder& rotation(int16_t angle) { if ((angle >= -90 && angle <= 90) || angle == 270) { rotation_ = angle;`
  - 说明：设置文本旋转角度
- `} StyleBuilder& indent(uint8_t level) { indent_ = level;`
  - 说明：设置缩进级别
- `} StyleBuilder& shrinkToFit(bool shrink_to_fit = true) { shrink_ = shrink_to_fit;`
  - 说明：设置收缩以适应
- `} // ========== 边框设置 ========== StyleBuilder& border(BorderStyle style, core::Color color = core::Color::BLACK) { left_border_ = right_border_ = top_border_ = bottom_border_ = style;`
  - 说明：设置所有边框
- `} StyleBuilder& leftBorder(BorderStyle style, core::Color color = core::Color::BLACK) { left_border_ = style;`
  - 说明：设置左边框
- `} StyleBuilder& rightBorder(BorderStyle style, core::Color color = core::Color::BLACK) { right_border_ = style;`
  - 说明：设置右边框
- `} StyleBuilder& topBorder(BorderStyle style, core::Color color = core::Color::BLACK) { top_border_ = style;`
  - 说明：设置上边框
- `} StyleBuilder& bottomBorder(BorderStyle style, core::Color color = core::Color::BLACK) { bottom_border_ = style;`
  - 说明：设置下边框
- `} StyleBuilder& diagonalBorder(BorderStyle style, DiagonalBorderType type = DiagonalBorderType::Both, core::Color color = core::Color::BLACK) { diag_border_ = style;`
  - 说明：设置对角线边框
- `} // ========== 填充设置 ========== StyleBuilder& fill(core::Color color) { pattern_ = PatternType::Solid;`
  - 说明：设置填充（纯色）
- `} StyleBuilder& fill(PatternType pattern, core::Color bg_color, core::Color fg_color = core::Color::BLACK) { pattern_ = pattern;`
  - 说明：设置填充模式
- `} StyleBuilder& backgroundColor(core::Color color) { if (pattern_ == PatternType::None) { pattern_ = PatternType::Solid;`
  - 说明：设置背景色
- `} // ========== 数字格式设置 ========== StyleBuilder& numberFormat(const std::string& format) { num_format_ = format;`
  - 说明：设置数字格式
- `} StyleBuilder& numberFormatIndex(uint16_t index) { num_format_index_ = index;`
  - 说明：设置数字格式索引
- `num_format_.clear(); // 清除自定义格式 return *this;`
- `} // 常用数字格式的便捷方法 StyleBuilder& currency() { return numberFormatIndex(7); } // ¤#,##0.00 StyleBuilder& percentage() { return numberFormatIndex(10); } // 0.00% StyleBuilder& date() { return numberFormatIndex(14); } // m/d/yyyy StyleBuilder& time() { return numberFormatIndex(21); } // h:mm:ss AM/PM StyleBuilder& dateTime() { return numberFormat("m/d/yyyy h:mm"); } StyleBuilder& scientific() { return numberFormatIndex(11); } // 0.00E+00 StyleBuilder& text() { return numberFormatIndex(49); } // @ // ========== 保护设置 ========== StyleBuilder& locked(bool locked = true) { locked_ = locked;`
  - 说明：设置单元格锁定
- `} StyleBuilder& unlocked(bool unlocked = true) { locked_ = !unlocked;`
  - 说明：设置单元格解锁
- `} StyleBuilder& hidden(bool hidden = true) { hidden_ = hidden;`
  - 说明：设置公式隐藏
- `} // ========== 构建最终对象 ========== FormatDescriptor build() const;`
  - 说明：构建不可变的格式描述符
- `// ========== 预定义样式的静态工厂方法 ========== static StyleBuilder header() { return StyleBuilder() .bold() .fontSize(14) .centerAlign() .vcenterAlign();`
- `} static StyleBuilder title() { return StyleBuilder() .bold() .fontSize(16) .centerAlign() .vcenterAlign();`
- `} static StyleBuilder money() { return StyleBuilder() .currency() .rightAlign() .vcenterAlign();`
- `} static StyleBuilder percent() { return StyleBuilder() .percentage() .rightAlign() .vcenterAlign();`
- `} static StyleBuilder dateStyle() { return StyleBuilder() .date() .centerAlign() .vcenterAlign();`

## Workbook

Workbook类 - Excel工作簿（新架构）

_Declared in: `src/fastexcel/core/Workbook.hpp`_

- `static std::unique_ptr<Workbook> create(const Path& path);`
  - 说明：创建工作簿（直接可用，无需再调用open）
- `static std::unique_ptr<Workbook> openForReading(const Path& path);`
  - 说明：只读方式打开Excel文件（新API - 推荐）
- `static std::unique_ptr<Workbook> openForEditing(const Path& path);`
  - 说明：编辑方式打开Excel文件（新API - 推荐）
- `explicit Workbook(const Path& path);`
  - 说明：构造函数
- `~Workbook();`
  - 说明：析构函数
- `// 禁用拷贝构造和赋值 Workbook(const Workbook&) = delete;`
- `Workbook& operator=(const Workbook&) = delete;`
- `// 允许移动构造和赋值 Workbook(Workbook&&) = default;`
- `Workbook& operator=(Workbook&&) = default;`
- `// ========== 文件操作 ========== bool save();`
  - 说明：保存工作簿
- `bool saveAs(const std::string& filename);`
  - 说明：另存为
- `bool isOpen() const;`
  - 说明：检查工作簿是否已打开
- `bool close();`
  - 说明：关闭工作簿
- `// ========== 编辑模式/保真写回配置 ========== void setPreserveUnknownParts(bool enable) { preserve_unknown_parts_ = enable; } bool getPreserveUnknownParts() const { return preserve_unknown_parts_; } // ========== 工作表管理 ========== std::shared_ptr<Worksheet> addSheet(const std::string& name = "");`
  - 说明：添加工作表
- `std::shared_ptr<Worksheet> insertSheet(size_t index, const std::string& name = "");`
  - 说明：插入工作表
- `bool removeSheet(const std::string& name);`
  - 说明：删除工作表
- `bool removeSheet(size_t index);`
  - 说明：删除工作表
- `std::shared_ptr<Worksheet> getSheet(const std::string& name);`
  - 说明：获取工作表（按名称）
- `std::shared_ptr<Worksheet> getSheet(size_t index);`
  - 说明：获取工作表（按索引）
- `std::shared_ptr<const Worksheet> getSheet(const std::string& name) const;`
  - 说明：获取工作表（按名称，只读）
- `std::shared_ptr<const Worksheet> getSheet(size_t index) const;`
  - 说明：获取工作表（按索引，只读）
- `// 🚀 便捷的工作表访问操作符 std::shared_ptr<Worksheet> operator[](size_t index) { return getSheet(index);`
  - 说明：通过索引访问工作表（操作符重载）
- `} std::shared_ptr<const Worksheet> operator[](size_t index) const { return getSheet(index);`
  - 说明：通过索引访问工作表（只读操作符重载）
- `} std::shared_ptr<Worksheet> operator[](const std::string& name) { return getSheet(name);`
  - 说明：通过名称访问工作表（操作符重载）
- `} std::shared_ptr<const Worksheet> operator[](const std::string& name) const { return getSheet(name);`
  - 说明：通过名称访问工作表（只读操作符重载）
- `} size_t getSheetCount() const { return worksheets_.size(); } bool isEmpty() const { return worksheets_.empty(); } std::shared_ptr<Worksheet> getFirstSheet();`
  - 说明：获取第一个工作表
- `std::shared_ptr<const Worksheet> getFirstSheet() const;`
  - 说明：获取第一个工作表（只读版本）
- `std::shared_ptr<Worksheet> getLastSheet();`
  - 说明：获取最后一个工作表
- `std::shared_ptr<const Worksheet> getLastSheet() const;`
  - 说明：获取最后一个工作表（只读版本）
- `std::vector<std::string> getSheetNames() const;`
  - 说明：获取所有工作表名称
- `// 🚀 新API：便捷的工作表查找方法 bool hasSheet(const std::string& name) const;`
  - 说明：检查是否存在指定名称的工作表
- `std::shared_ptr<Worksheet> findSheet(const std::string& name);`
  - 说明：查找工作表（可能不存在）
- `std::shared_ptr<const Worksheet> findSheet(const std::string& name) const;`
  - 说明：查找工作表（只读版本）
- `std::vector<std::shared_ptr<Worksheet>> getAllSheets();`
  - 说明：获取所有工作表
- `std::vector<std::shared_ptr<const Worksheet>> getAllSheets() const;`
  - 说明：获取所有工作表（只读版本）
- `int clearAllSheets();`
  - 说明：清空所有工作表
- `bool renameSheet(const std::string& old_name, const std::string& new_name);`
  - 说明：重命名工作表
- `bool moveSheet(size_t from_index, size_t to_index);`
  - 说明：移动工作表
- `std::shared_ptr<Worksheet> copyWorksheet(const std::string& source_name, const std::string& new_name);`
  - 说明：复制工作表
- `std::shared_ptr<Worksheet> copyWorksheetFrom(const std::shared_ptr<const Worksheet>& source_worksheet, const std::string& new_name = "");`
  - 说明：复制工作表从另一个工作簿
- `void setActiveWorksheet(size_t index);`
  - 说明：设置活动工作表
- `std::shared_ptr<Worksheet> getActiveWorksheet();`
  - 说明：获取活动工作表
- `std::shared_ptr<const Worksheet> getActiveWorksheet() const;`
  - 说明：获取活动工作表（只读）
- `// 🚀 新API：便捷的单元格访问方法（跨工作表） template<typename T> T getValue(size_t sheet_index, int row, int col) const { auto worksheet = getSheet(sheet_index);`
  - 说明：通过工作表索引和单元格坐标获取值
- `if (!worksheet) { throw std::runtime_error("Invalid worksheet index: " + std::to_string(sheet_index));`
- `} return worksheet->getValue<T>(row, col);`
- `} template<typename T> void setValue(const std::string& sheet_name, int row, int col, const T& value) { auto worksheet = getSheet(sheet_name);`
  - 说明：通过工作表名称和单元格坐标设置值
- `if (!worksheet) { throw std::runtime_error("Worksheet not found: " + sheet_name);`
- `} worksheet->setValue<T>(row, col, value);`
- `} template<typename T> void setValue(size_t sheet_index, int row, int col, const T& value) { auto worksheet = getSheet(sheet_index);`
  - 说明：通过工作表索引和单元格坐标设置值
- `if (!worksheet) { throw std::runtime_error("Invalid worksheet index: " + std::to_string(sheet_index));`
- `} worksheet->setValue<T>(row, col, value);`
- `} // 🚀 新API：安全版本的跨工作表访问方法（不抛异常） std::optional<std::shared_ptr<Worksheet>> tryGetSheet(const std::string& name) noexcept { try { auto sheet = findSheet(name);`
  - 说明：安全获取工作表指针
- `return sheet ? std::make_optional(sheet) : std::nullopt;`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<std::shared_ptr<Worksheet>> tryGetSheet(size_t index) noexcept { try { auto sheet = getSheet(index);`
  - 说明：安全获取工作表指针（索引版本）
- `return sheet ? std::make_optional(sheet) : std::nullopt;`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> std::optional<T> tryGetValue(const std::string& sheet_name, int row, int col) const noexcept { try { auto worksheet = findSheet(sheet_name);`
  - 说明：安全获取单元格值（通过工作表名称）
- `if (!worksheet) { return std::nullopt;`
- `} return worksheet->tryGetValue<T>(row, col);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> std::optional<T> tryGetValue(size_t sheet_index, int row, int col) const noexcept { try { if (sheet_index >= worksheets_.size()) { return std::nullopt;`
  - 说明：安全获取单元格值（通过工作表索引）
- `if (!worksheet) { return std::nullopt;`
- `} return worksheet->tryGetValue<T>(row, col);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> bool trySetValue(const std::string& sheet_name, int row, int col, const T& value) noexcept { try { auto worksheet = findSheet(sheet_name);`
  - 说明：安全设置单元格值（通过工作表名称）
- `if (!worksheet) { return false;`
- `} worksheet->setValue<T>(row, col, value);`
- `} catch (...) { return false;`
- `} } template<typename T> T getValue(const std::string& full_address) const { auto [sheet_name, row, col] = utils::AddressParser::parseAddress(full_address);`
  - 说明：通过完整地址字符串访问单元格（支持跨工作表）
- `if (sheet_name.empty()) { // 如果没有工作表名，使用第一个工作表 return getValue<T>(0, row, col);`
- `} auto worksheet = getSheet(sheet_name);`
- `if (!worksheet) { throw std::runtime_error("Worksheet not found: " + sheet_name);`
- `} return worksheet->getValue<T>(row, col);`
- `} template<typename T> void setValue(const std::string& full_address, const T& value) { auto [sheet_name, row, col] = utils::AddressParser::parseAddress(full_address);`
  - 说明：通过完整地址字符串设置单元格值（支持跨工作表）
- `if (sheet_name.empty()) { // 如果没有工作表名，使用第一个工作表 setValue<T>(0, row, col, value);`
- `} auto worksheet = getSheet(sheet_name);`
- `if (!worksheet) { throw std::runtime_error("Worksheet not found: " + sheet_name);`
- `} worksheet->setValue<T>(row, col, value);`
- `} // ========== 样式管理 ========== int addStyle(const FormatDescriptor& style);`
  - 说明：添加样式到工作簿
- `int addStyle(const StyleBuilder& builder);`
  - 说明：添加样式到工作簿（使用Builder）
- `int addNamedStyle(const NamedStyle& named_style);`
  - 说明：添加命名样式
- `StyleBuilder createStyleBuilder() const;`
  - 说明：创建样式构建器
- `std::shared_ptr<const FormatDescriptor> getStyle(int style_id) const;`
  - 说明：根据ID获取样式
- `int getDefaultStyleId() const;`
  - 说明：获取默认样式ID
- `bool isValidStyleId(int style_id) const;`
  - 说明：检查样式ID是否有效
- `size_t getStyleCount() const;`
  - 说明：获取样式数量
- `const FormatRepository& getStyles() const;`
  - 说明：获取样式仓储（只读访问）
- `void setThemeXML(const std::string& theme_xml);`
  - 说明：设置自定义主题XML
- `void setOriginalThemeXML(const std::string& theme_xml);`
  - 说明：设置原始主题XML（仅供读取器使用，保持保真）
- `void setTheme(const theme::Theme& theme);`
  - 说明：设置主题（结构化对象）
- `const theme::Theme* getTheme() const { return theme_.get(); } void setThemeName(const std::string& name);`
  - 说明：设置主题名称
- `void setThemeColor(theme::ThemeColorScheme::ColorType type, const core::Color& color);`
  - 说明：通过类型设置主题颜色
- `bool setThemeColorByName(const std::string& name, const core::Color& color);`
  - 说明：通过名称设置主题颜色（如 "accent1"/"lt1"/"hlink" 等）
- `void setThemeMajorFontLatin(const std::string& name);`
  - 说明：设置主题的major字体族
- `void setThemeMajorFontEastAsia(const std::string& name);`
- `void setThemeMajorFontComplex(const std::string& name);`
- `void setThemeMinorFontLatin(const std::string& name);`
  - 说明：设置主题的minor字体族
- `void setThemeMinorFontEastAsia(const std::string& name);`
- `void setThemeMinorFontComplex(const std::string& name);`
- `const std::string& getThemeXML() const;`
  - 说明：获取当前主题XML
- `std::unique_ptr<StyleTransferContext> copyStylesFrom( const Workbook& source_workbook);`
  - 说明：从另一个工作簿复制样式
- `FormatRepository::DeduplicationStats getStyleStats() const;`
  - 说明：获取样式去重统计
- `// ========== 文档属性 ========== void setTitle(const std::string& title) { doc_properties_.title = title; } const std::string& getTitle() const { return doc_properties_.title; } void setSubject(const std::string& subject) { doc_properties_.subject = subject; } const std::string& getSubject() const { return doc_properties_.subject; } void setAuthor(const std::string& author) { doc_properties_.author = author; } const std::string& getAuthor() const { return doc_properties_.author; } void setManager(const std::string& manager) { doc_properties_.manager = manager; } void setCompany(const std::string& company) { doc_properties_.company = company; } void setCategory(const std::string& category) { doc_properties_.category = category; } void setKeywords(const std::string& keywords) { doc_properties_.keywords = keywords; } void setComments(const std::string& comments) { doc_properties_.comments = comments; } void setStatus(const std::string& status) { doc_properties_.status = status; } void setHyperlinkBase(const std::string& hyperlink_base) { doc_properties_.hyperlink_base = hyperlink_base; } void setCreatedTime(const std::tm& created_time) { doc_properties_.created_time = created_time; } void setModifiedTime(const std::tm& modified_time) { doc_properties_.modified_time = modified_time; } void setDocumentProperties(const std::string& title = "", const std::string& subject = "", const std::string& author = "", const std::string& company = "", const std::string& comments = "");`
  - 说明：批量设置文档属性（新API）
- `void setApplication(const std::string& application);`
  - 说明：设置应用程序名称（新API）
- `// ========== 自定义属性 ========== void setProperty(const std::string& name, const std::string& value);`
  - 说明：添加自定义属性（字符串）
- `void setProperty(const std::string& name, double value);`
  - 说明：添加自定义属性（数字）
- `void setProperty(const std::string& name, bool value);`
  - 说明：添加自定义属性（布尔）
- `std::string getProperty(const std::string& name) const;`
  - 说明：获取自定义属性
- `bool removeProperty(const std::string& name);`
  - 说明：删除自定义属性
- `std::unordered_map<std::string, std::string> getAllProperties() const;`
  - 说明：获取所有自定义属性
- `// ========== 定义名称 ========== void defineName(const std::string& name, const std::string& formula, const std::string& scope = "");`
  - 说明：定义名称
- `std::string getDefinedName(const std::string& name, const std::string& scope = "") const;`
  - 说明：获取定义名称的公式
- `bool removeDefinedName(const std::string& name, const std::string& scope = "");`
  - 说明：删除定义名称
- `// ========== VBA项目 ========== bool addVbaProject(const std::string& vba_project_path);`
  - 说明：添加VBA项目
- `bool hasVbaProject() const { return has_vba_; } // ========== 工作簿保护 ========== void protect(const std::string& password = "", bool lock_structure = true, bool lock_windows = false);`
  - 说明：保护工作簿
- `void unprotect();`
  - 说明：取消保护
- `bool isProtected() const { return protected_; } // ========== 工作簿选项 ========== void setConstantMemory(bool constant_memory) { options_.constant_memory = constant_memory; } void setTmpDir(const std::string& tmpdir) { options_.tmpdir = tmpdir; } void setReadOnlyRecommended(bool read_only_recommended) { options_.read_only_recommended = read_only_recommended; } void setCalcOptions(bool calc_on_load, bool full_calc_on_load = false);`
  - 说明：设置计算选项
- `void setUseSharedStrings(bool enable) { options_.use_shared_strings = enable; } void setMode(WorkbookMode mode) { options_.mode = mode;`
  - 说明：设置工作簿模式
- `} WorkbookMode getMode() const { return options_.mode; } void setAutoModeThresholds(size_t cell_threshold, size_t memory_threshold) { options_.auto_mode_cell_threshold = cell_threshold;`
  - 说明：设置自动模式阈值
- `} void setRowBufferSize(size_t size) { options_.row_buffer_size = size; } void setCompressionLevel(int level) { options_.compression_level = level; } void setXMLBufferSize(size_t size) { options_.xml_buffer_size = size; } void setHighPerformanceMode(bool enable);`
  - 说明：启用高性能模式（自动配置最佳性能参数）
- `// ========== 获取状态 ========== // 获取脏数据管理器 DirtyManager* getDirtyManager() { return dirty_manager_.get(); } const DirtyManager* getDirtyManager() const { return dirty_manager_.get(); } // 生成控制（基于DirtyManager的新实现） bool shouldGenerateContentTypes() const;`
- `bool shouldGenerateRootRels() const;`
- `bool shouldGenerateWorkbookCore() const;`
- `bool shouldGenerateStyles() const;`
- `bool shouldGenerateTheme() const;`
- `bool shouldGenerateSharedStrings() const;`
- `bool shouldGenerateDocPropsCore() const;`
- `bool shouldGenerateDocPropsApp() const;`
- `bool shouldGenerateDocPropsCustom() const;`
- `bool shouldGenerateSheet(size_t index) const;`
- `bool shouldGenerateSheetRels(size_t index) const;`
- `bool isReadOnly() const { return state_ == WorkbookState::READING; } bool isEditable() const { return state_ == WorkbookState::EDITING || state_ == WorkbookState::CREATING; } const std::string& getFilename() const { return filename_; } const DocumentProperties& getDocumentProperties() const { return doc_properties_; } WorkbookOptions& getOptions() { return options_; } const WorkbookOptions& getOptions() const { return options_; } // ========== 共享字符串管理 ========== int addSharedString(const std::string& str);`
  - 说明：添加共享字符串
- `int addSharedStringWithIndex(const std::string& str, int original_index);`
  - 说明：添加共享字符串并保持原始索引（用于文件复制）
- `int getSharedStringIndex(const std::string& str) const;`
  - 说明：获取共享字符串索引
- `const SharedStringTable* getSharedStrings() const;`
  - 说明：获取共享字符串表
- `// ========== 工作簿编辑功能 ========== static std::unique_ptr<Workbook> open(const Path& path);`
  - 说明：打开现有文件进行编辑（直接可用，无需再调用open）
- `bool refresh();`
  - 说明：刷新工作簿（重新读取文件内容）
- `bool mergeWorkbook(const std::unique_ptr<Workbook>& other_workbook, const MergeOptions& options = {});`
  - 说明：合并另一个工作簿的内容
- `bool exportWorksheets(const std::vector<std::string>& worksheet_names, const std::string& output_filename);`
  - 说明：导出工作表到新工作簿
- `int batchRenameWorksheets(const std::unordered_map<std::string, std::string>& rename_map);`
  - 说明：批量重命名工作表
- `int batchRemoveWorksheets(const std::vector<std::string>& worksheet_names);`
  - 说明：批量删除工作表
- `bool reorderWorksheets(const std::vector<std::string>& new_order);`
  - 说明：重新排序工作表
- `int findAndReplaceAll(const std::string& find_text, const std::string& replace_text, const FindReplaceOptions& options = {});`
  - 说明：查找并替换（全工作簿）
- `std::vector<std::tuple<std::string, int, int>> findAll(const std::string& search_text, const FindReplaceOptions& options = {});`
  - 说明：全局查找
- `WorkbookStats getStatistics() const;`
  - 说明：获取工作簿统计信息
- `bool isModified() const;`
  - 说明：检查工作簿是否已修改（新API）
- `size_t getTotalMemoryUsage() const;`
  - 说明：获取内存使用总量（新API）
- `size_t optimize();`
  - 说明：优化工作簿（压缩样式、清理未使用资源，新API）

## Worksheet

Worksheet类 - Excel工作表

_Declared in: `src/fastexcel/core/Worksheet.hpp`_

- `explicit Worksheet(const std::string& name, std::shared_ptr<Workbook> workbook, int sheet_id = 1);`
- `~Worksheet() = default;`
- `// 禁用拷贝构造和赋值 Worksheet(const Worksheet&) = delete;`
- `Worksheet& operator=(const Worksheet&) = delete;`
- `// 允许移动构造和赋值 Worksheet(Worksheet&&) = default;`
- `Worksheet& operator=(Worksheet&&) = default;`
- `// ========== 优化功能 ========== void setSharedStringTable(SharedStringTable* sst) { sst_ = sst; } void setFormatRepository(FormatRepository* format_repo) { format_repo_ = format_repo; } void setOptimizeMode(bool enable);`
  - 说明：启用/禁用优化模式
- `bool isOptimizeMode() const { return optimize_mode_; } void flushCurrentRow();`
  - 说明：刷新当前行缓存
- `size_t getMemoryUsage() const;`
  - 说明：获取内存使用情况
- `PerformanceStats getPerformanceStats() const;`
  - 说明：获取性能统计信息
- `// ========== 基本单元格操作 ========== Cell& getCell(int row, int col);`
  - 说明：获取单元格引用
- `const Cell& getCell(int row, int col) const;`
- `// 🚀 新API：模板化的单元格值获取和设置 template<typename T> T getValue(int row, int col) const { return getCell(row, col).getValue<T>();`
  - 说明：模板化获取单元格值
- `} template<typename T> void setValue(int row, int col, const T& value) { getCell(row, col).setValue<T>(value);`
  - 说明：模板化设置单元格值
- `} template<typename T> void setCellValue(int row, int col, const T& value) { setValue<T>(row, col, value);`
  - 说明：setCellValue - setValue的语义化别名
- `} // 🚀 智能单元格格式设置 API - 语义明确！ void setCellFormat(int row, int col, const core::FormatDescriptor& format);`
  - 说明：设置单元格格式（智能优化版）
- `void setCellFormat(int row, int col, std::shared_ptr<const core::FormatDescriptor> format);`
- `void setCellFormat(int row, int col, const core::StyleBuilder& builder);`
- `// ========== 范围格式化API ========== RangeFormatter rangeFormatter(const std::string& range);`
  - 说明：创建范围格式化器
- `RangeFormatter rangeFormatter(int start_row, int start_col, int end_row, int end_col);`
  - 说明：创建范围格式化器（坐标版本）
- `std::optional<std::shared_ptr<const FormatDescriptor>> tryGetCellFormat(int row, int col) const noexcept { try { if (!hasCellAt(row, col)) { return std::nullopt;`
  - 说明：安全获取单元格格式
- `} const auto& cell = getCell(row, col);`
- `auto format = cell.getFormatDescriptor();`
- `return format ? std::make_optional(format) : std::nullopt;`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<double> tryGetColumnWidth(int col) const noexcept { try { if (col < 0) return std::nullopt;`
  - 说明：安全获取列宽
- `return std::make_optional(getColumnWidth(col));`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<double> tryGetRowHeight(int row) const noexcept { try { if (row < 0) return std::nullopt;`
  - 说明：安全获取行高
- `return std::make_optional(getRowHeight(row));`
- `} catch (...) { return std::nullopt;`
- `} } std::optional<std::pair<int, int>> tryGetUsedRange() const noexcept { try { auto range = getUsedRange();`
  - 说明：安全获取使用范围
- `if (range.first == -1 || range.second == -1) { return std::nullopt;`
- `} return std::make_optional(range);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> std::optional<T> tryGetValue(int row, int col) const noexcept { if (!hasCellAt(row, col)) { return std::nullopt;`
  - 说明：安全获取单元格值（不抛异常）
- `} return getCell(row, col).tryGetValue<T>();`
- `} template<typename T> T getValueOr(int row, int col, const T& default_value) const noexcept { if (!hasCellAt(row, col)) { return default_value;`
  - 说明：获取单元格值或默认值
- `} return getCell(row, col).getValueOr<T>(default_value);`
- `} // 🚀 新API：Excel地址格式支持 template<typename T> T getValue(const std::string& address) const { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - 说明：通过Excel地址获取单元格值
- `return getValue<T>(row, col);`
- `} template<typename T> void setValue(const std::string& address, const T& value) { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - 说明：通过Excel地址设置单元格值
- `setValue<T>(row, col, value);`
- `} template<typename T> void setCellValue(const std::string& address, const T& value) { setValue<T>(address, value);`
  - 说明：setCellValue - setValue的语义化别名（字符串地址版本）
- `} template<typename T> std::optional<T> tryGetValue(const std::string& address) const noexcept { try { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - 说明：通过Excel地址安全获取单元格值
- `return tryGetValue<T>(row, col);`
- `} catch (...) { return std::nullopt;`
- `} } template<typename T> T getValueOr(const std::string& address, const T& default_value) const noexcept { try { auto [sheet, row, col] = utils::AddressParser::parseAddress(address);`
  - 说明：通过Excel地址获取单元格值或默认值
- `return getValueOr<T>(row, col, default_value);`
- `} catch (...) { return default_value;`
- `} } void writeDateTime(int row, int col, const std::tm& datetime);`
  - 说明：写入日期时间
- `void writeUrl(int row, int col, const std::string& url, const std::string& string = "");`
  - 说明：写入URL链接
- `// ========== 批量数据操作 ========== // 🚀 新API：模板化范围操作 template<typename T> std::vector<std::vector<T>> getRange(int start_row, int start_col, int end_row, int end_col) const { std::vector<std::vector<T>> result;`
  - 说明：获取范围内的所有值
- `result.reserve(end_row - start_row + 1);`
- `for (int row = start_row; row <= end_row; ++row) { std::vector<T> row_data;`
- `row_data.reserve(end_col - start_col + 1);`
- `for (int col = start_col; col <= end_col; ++col) { if (hasCellAt(row, col)) { row_data.push_back(getCell(row, col).getValue<T>());`
- `} else { // 空单元格返回默认值 if constexpr (std::is_same_v<T, std::string>) { row_data.push_back("");`
- `} else if constexpr (std::is_arithmetic_v<T>) { row_data.push_back(static_cast<T>(0));`
- `} else if constexpr (std::is_same_v<T, bool>) { row_data.push_back(false);`
- `} } } result.push_back(std::move(row_data));`
- `} template<typename T> std::vector<std::vector<T>> getRange(const std::string& range) const { auto [sheet, start_row, start_col, end_row, end_col] = utils::AddressParser::parseRange(range);`
  - 说明：通过Excel地址获取范围内的所有值
- `return getRange<T>(start_row, start_col, end_row, end_col);`
- `} template<typename T> void setRange(int start_row, int start_col, const std::vector<std::vector<T>>& data) { for (size_t row_idx = 0; row_idx < data.size(); ++row_idx) { for (size_t col_idx = 0; col_idx < data[row_idx].size(); ++col_idx) { int target_row = static_cast<int>(start_row + row_idx);`
  - 说明：设置范围内的所有值
- `int target_col = static_cast<int>(start_col + col_idx);`
- `setValue<T>(target_row, target_col, data[row_idx][col_idx]);`
- `} } } template<typename T> void setRange(const std::string& range, const std::vector<std::vector<T>>& data) { auto [sheet, start_row, start_col, end_row, end_col] = utils::AddressParser::parseRange(range);`
  - 说明：通过Excel地址设置范围内的所有值
- `setRange<T>(start_row, start_col, data);`
- `} // 🚀 新API：链式调用支持 WorksheetChain chain();`
  - 说明：获取链式调用对象
- `// ========== 行列操作 ========== void setColumnWidth(int col, double width);`
  - 说明：设置列宽
- `void setColumnWidth(int first_col, int last_col, double width);`
  - 说明：设置列宽范围
- `void setColumnFormatId(int col, int format_id);`
  - 说明：设置列格式
- `void setColumnFormatId(int first_col, int last_col, int format_id);`
  - 说明：设置列格式范围
- `void setColumnFormat(int col, std::shared_ptr<Format> format);`
  - 说明：设置列格式
- `void setColumnFormat(int first_col, int last_col, std::shared_ptr<Format> format);`
  - 说明：设置列格式范围
- `void hideColumn(int col);`
  - 说明：隐藏列
- `void hideColumn(int first_col, int last_col);`
  - 说明：隐藏列范围
- `void setRowHeight(int row, double height);`
  - 说明：设置行高
- `void setRowFormat(int row, std::shared_ptr<Format> format);`
  - 说明：设置行格式
- `void hideRow(int row);`
  - 说明：隐藏行
- `void hideRow(int first_row, int last_row);`
  - 说明：隐藏行范围
- `// ========== 合并单元格 ========== void mergeCells(int first_row, int first_col, int last_row, int last_col);`
  - 说明：合并单元格
- `// ========== 自动筛选 ========== void setAutoFilter(int first_row, int first_col, int last_row, int last_col);`
  - 说明：设置自动筛选
- `void removeAutoFilter();`
  - 说明：移除自动筛选
- `// ========== 冻结窗格 ========== void freezePanes(int row, int col);`
  - 说明：冻结窗格
- `void freezePanes(int row, int col, int top_left_row, int top_left_col);`
  - 说明：冻结窗格（指定左上角单元格）
- `void splitPanes(int row, int col);`
  - 说明：分割窗格
- `// ========== 打印设置 ========== void setPrintArea(int first_row, int first_col, int last_row, int last_col);`
  - 说明：设置打印区域
- `void setRepeatRows(int first_row, int last_row);`
  - 说明：设置重复打印行
- `void setRepeatColumns(int first_col, int last_col);`
  - 说明：设置重复打印列
- `void setLandscape(bool landscape = true);`
  - 说明：设置页面方向
- `void setPaperSize(int paper_size);`
  - 说明：设置纸张大小
- `void setMargins(double left, double right, double top, double bottom);`
  - 说明：设置页边距
- `void setHeaderFooterMargins(double header, double footer);`
  - 说明：设置页眉页脚边距
- `void setPrintScale(int scale);`
  - 说明：设置打印缩放
- `void setFitToPages(int width, int height);`
  - 说明：适合页面打印
- `void setPrintGridlines(bool print = true);`
  - 说明：设置打印网格线
- `void setPrintHeadings(bool print = true);`
  - 说明：设置打印标题
- `void setCenterOnPage(bool horizontal, bool vertical);`
  - 说明：设置页面居中
- `// ========== 工作表保护 ========== void protect(const std::string& password = "");`
  - 说明：保护工作表
- `void unprotect();`
  - 说明：取消保护
- `bool isProtected() const { return protected_; } // ========== 视图设置 ========== void setZoom(int scale);`
  - 说明：设置缩放比例
- `void showGridlines(bool show = true);`
  - 说明：显示/隐藏网格线
- `void showRowColHeaders(bool show = true);`
  - 说明：显示/隐藏行列标题
- `void setRightToLeft(bool rtl = true);`
  - 说明：设置从右到左显示
- `void setTabSelected(bool selected = true);`
  - 说明：设置选中状态
- `void setActiveCell(int row, int col);`
  - 说明：设置活动单元格
- `void setSelection(int first_row, int first_col, int last_row, int last_col);`
  - 说明：设置选中范围
- `// ========== 获取信息 ========== const std::string& getName() const { return name_; } void setName(const std::string& name) { name_ = name; } int getSheetId() const { return sheet_id_; } std::shared_ptr<Workbook> getParentWorkbook() const { return parent_workbook_; } std::pair<int, int> getUsedRange() const;`
  - 说明：获取使用范围
- `size_t getCellCount() const { return cells_.size(); } // 🚀 新API：便捷的工作表状态检查方法 bool isEmpty() const { return cells_.empty(); } bool hasData() const { return !cells_.empty(); } int getRowCount() const;`
  - 说明：获取总行数（有数据的行）
- `int getColumnCount() const;`
  - 说明：获取总列数（有数据的列）
- `int getCellCountInRow(int row) const;`
  - 说明：获取指定行的单元格数量
- `int getCellCountInColumn(int col) const;`
  - 说明：获取指定列的单元格数量
- `bool hasCellAt(int row, int col) const;`
  - 说明：检查单元格是否存在
- `double getColumnWidth(int col) const;`
  - 说明：获取列宽
- `double getRowHeight(int row) const;`
  - 说明：获取行高
- `std::shared_ptr<Format> getColumnFormat(int col) const;`
  - 说明：获取列格式
- `std::shared_ptr<Format> getRowFormat(int row) const;`
  - 说明：获取行格式
- `int getColumnFormatId(int col) const;`
  - 说明：获取列格式ID
- `const std::unordered_map<int, ColumnInfo>& getColumnInfo() const { return column_info_; } bool isColumnHidden(int col) const;`
  - 说明：检查列是否隐藏
- `bool isRowHidden(int row) const;`
  - 说明：检查行是否隐藏
- `const std::vector<MergeRange>& getMergeRanges() const { return merge_ranges_; } bool hasAutoFilter() const { return autofilter_ != nullptr; } AutoFilterRange getAutoFilterRange() const;`
  - 说明：获取自动筛选范围
- `bool hasFrozenPanes() const { return freeze_panes_ != nullptr; } FreezePanes getFreezeInfo() const;`
  - 说明：获取冻结窗格信息
- `AutoFilterRange getPrintArea() const;`
  - 说明：获取打印区域
- `std::pair<int, int> getRepeatRows() const;`
  - 说明：获取重复行范围
- `std::pair<int, int> getRepeatColumns() const;`
  - 说明：获取重复列范围
- `bool isLandscape() const { return print_settings_.landscape; } struct Margins { double left, right, top, bottom;`
  - 说明：获取页边距
- `Margins getMargins() const;`
- `int getPrintScale() const { return print_settings_.scale; } std::pair<int, int> getFitToPages() const;`
  - 说明：获取适应页面设置
- `bool isPrintGridlines() const { return print_settings_.print_gridlines; } bool isPrintHeadings() const { return print_settings_.print_headings; } bool isCenterHorizontally() const { return print_settings_.center_horizontally; } bool isCenterVertically() const { return print_settings_.center_vertically; } const std::string& getProtectionPassword() const { return protection_password_; } int getZoom() const { return sheet_view_.zoom_scale; } bool isGridlinesVisible() const { return sheet_view_.show_gridlines; } bool isRowColHeadersVisible() const { return sheet_view_.show_row_col_headers; } bool isRightToLeft() const { return sheet_view_.right_to_left; } bool isTabSelected() const { return sheet_view_.tab_selected; } const std::string& getActiveCell() const { return active_cell_; } const std::string& getSelection() const { return selection_; } // ========== XML生成 ========== void generateXML(const std::function<void(const char*, size_t)>& callback) const;`
  - 说明：生成工作表XML到回调函数（使用UnifiedXMLGenerator）
- `void generateRelsXML(const std::function<void(const char*, size_t)>& callback) const;`
  - 说明：生成工作表关系XML到回调函数（流式写入）
- `void generateRelsXMLToFile(const std::string& filename) const;`
  - 说明：生成工作表关系XML到文件（流式写入）
- `// ========== 工具方法 ========== void clear();`
  - 说明：清空工作表
- `void clearRange(int first_row, int first_col, int last_row, int last_col);`
  - 说明：清空指定区域
- `void insertRows(int row, int count = 1);`
  - 说明：插入行
- `void insertColumns(int col, int count = 1);`
  - 说明：插入列
- `void deleteRows(int row, int count = 1);`
  - 说明：删除行
- `void deleteColumns(int col, int count = 1);`
  - 说明：删除列
- `// ========== 单元格编辑功能 ========== void editCellValue(int row, int col, const std::string& value, bool preserve_format = true);`
  - 说明：修改现有单元格的值
- `void editCellValue(int row, int col, double value, bool preserve_format = true);`
- `void editCellValue(int row, int col, bool value, bool preserve_format = true);`
- `void editCellFormat(int row, int col, std::shared_ptr<Format> format);`
  - 说明：修改单元格格式
- `void copyCell(int src_row, int src_col, int dst_row, int dst_col, bool copy_format = true, bool copy_row_height = false);`
  - 说明：复制单元格
- `void moveCell(int src_row, int src_col, int dst_row, int dst_col);`
  - 说明：移动单元格
- `void copyRange(int src_first_row, int src_first_col, int src_last_row, int src_last_col, int dst_row, int dst_col, bool copy_format = true);`
  - 说明：复制范围
- `void moveRange(int src_first_row, int src_first_col, int src_last_row, int src_last_col, int dst_row, int dst_col);`
  - 说明：移动范围
- `int findAndReplace(const std::string& find_text, const std::string& replace_text, bool match_case = false, bool match_entire_cell = false);`
  - 说明：查找并替换
- `std::vector<std::pair<int, int>> findCells(const std::string& search_text, bool match_case = false, bool match_entire_cell = false) const;`
  - 说明：查找单元格
- `void sortRange(int first_row, int first_col, int last_row, int last_col, int sort_column = 0, bool ascending = true, bool has_header = false);`
  - 说明：排序范围
- `// ========== 共享公式管理 ========== int createSharedFormula(int first_row, int first_col, int last_row, int last_col, const std::string& formula);`
  - 说明：创建共享公式
- `const SharedFormulaManager* getSharedFormulaManager() const { return shared_formula_manager_.get(); } // 🚀 新API：便捷的行列操作方法 template<typename T> int appendRow(const std::vector<T>& data) { auto [max_row, max_col] = getUsedRange();`
  - 说明：追加行数据
- `for (size_t i = 0; i < data.size(); ++i) { setValue(new_row, static_cast<int>(i), data[i]);`
- `} template<typename T> std::vector<T> getRowData(int row) const { std::vector<T> result;`
  - 说明：获取整行的数据
- `auto [max_row, max_col] = getUsedRange();`
- `for (int col = 0; col <= max_col; ++col) { if (hasCellAt(row, col)) { result.push_back(getValue<T>(row, col));`
- `} else { result.push_back(T{}); // 默认值 } } return result;`
- `} template<typename T> std::vector<T> getColumnData(int col) const { std::vector<T> result;`
  - 说明：获取整列的数据
- `auto [max_row, max_col] = getUsedRange();`
- `for (int row = 0; row <= max_row; ++row) { if (hasCellAt(row, col)) { result.push_back(getValue<T>(row, col));`
- `} else { result.push_back(T{}); // 默认值 } } return result;`
- `} void clearRow(int row);`
  - 说明：清空指定行的所有数据
- `void clearColumn(int col);`
  - 说明：清空指定列的所有数据
- `void clearAll();`
  - 说明：清空所有单元格数据
- `template<typename T> void setRowData(int row, const std::vector<T>& data, int start_col = 0) { for (size_t i = 0; i < data.size(); ++i) { setValue(row, start_col + static_cast<int>(i), data[i]);`
  - 说明：批量设置行数据
- `} } template<typename T> void setColumnData(int col, const std::vector<T>& data, int start_row = 0) { for (size_t i = 0; i < data.size(); ++i) { setValue(start_row + static_cast<int>(i), col, data[i]);`
  - 说明：批量设置列数据

## fastexcel (namespace)

_Declared in: `src/fastexcel/FastExcel.hpp`_

- `inline std::string getVersion();`
- `FASTEXCEL_API void cleanup();`
  - 说明：清理FastExcel库资源
- `FASTEXCEL_API core::StyleBuilder createStyle();`
  - 说明：创建样式构建器

